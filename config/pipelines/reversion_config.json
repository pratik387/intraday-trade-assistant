{
    "_comment": "REVERSION Pipeline Configuration - Values from configuration.json verified against pro Indian trading research",
    "_category": "REVERSION",
    "_description": "Mean reversion plays (failure fade, volume spike reversal, gap fill, liquidity sweep)",

    "setup_types": [
        "failure_fade_long", "failure_fade_short",
        "volume_spike_reversal_long", "volume_spike_reversal_short",
        "gap_fill_long", "gap_fill_short",
        "vwap_mean_reversion_long", "vwap_mean_reversion_short",
        "liquidity_sweep_long", "liquidity_sweep_short",
        "fair_value_gap_long", "fair_value_gap_short",
        "range_deviation_long", "range_deviation_short",
        "range_mean_reversion_long", "range_mean_reversion_short"
    ],

    "screening": {
        "time_windows": {
            "_comment": "From configuration.json time_policy + research: 09:15 start, avoid 11-12 (36.6% WR worst), golden hour 14:30-15:30",
            "morning_start": "09:15",
            "morning_end": "11:00",
            "avoid_window_start": "11:00",
            "avoid_window_end": "12:00",
            "afternoon_start": "13:00",
            "afternoon_end": "14:45",
            "golden_hour_start": "14:30",
            "golden_hour_end": "15:30",
            "last_entry_cutoff": "14:45"
        },
        "extension": {
            "_comment": "ALIGNED TO BASELINE: vwap_reclaim min_distance_bps: 30 (0.30%), max_distance_bps: 200 (2.0%)",
            "min_vwap_extension_pct": 0.30,
            "max_vwap_extension_pct": 2.0
        },
        "rsi_extremes": {
            "_comment": "REVERTED: oversold_threshold 30→35 as stricter threshold killed profitable setups",
            "oversold_threshold": 35,
            "overbought_threshold": 70
        },
        "volume_spike_threshold": 1.5
    },

    "quality": {
        "_comment": "From configuration.json - min_t1_rr: 1.2. UPDATED: 0.8→1.2 to require higher quality setups",
        "min_structural_rr": 1.2,
        "vwap_distance_weight": 0.5,
        "exhaustion_weight": 2.0,
        "volume_exhaustion": {
            "_comment": "From configuration.json - min_volume_mult: 1.5 for vwap_mean_reversion",
            "threshold": 1.5,
            "multiplier": 0.5
        },
        "quality_thresholds": {
            "_comment": "UPDATED: Increased thresholds - require more exhaustion/extension for reversion plays",
            "excellent": {
                "min_exhaustion_score": 0.6,
                "min_vwap_distance_atr": 1.8
            },
            "good": {
                "min_exhaustion_score": 0.4,
                "min_vwap_distance_atr": 1.2
            },
            "fair": {
                "min_exhaustion_score": 0.2,
                "min_vwap_distance_atr": 0.8
            }
        },
        "rsi_exhaustion": {
            "long": {
                "threshold": 30,
                "divisor": 30
            },
            "short": {
                "threshold": 70,
                "divisor": 30
            }
        }
    },

    "gates": {
        "_comment": "From configuration.json failure_fade - min_volume_mult: 1.2, min_fade_strength: 0.6",
        "regime_rules": {
            "chop": {
                "_comment": "Research: Mean reversion excels in chop. 43.8% WR, 1.63 PF per baseline",
                "allowed": true,
                "size_mult": 1.3
            },
            "trend_up": {
                "_comment": "Counter-trend needs stronger confirmation",
                "allowed": true,
                "size_mult": 1.0,
                "min_strength_counter_trend": 1.5,
                "counter_trend_size_mult": 0.7
            },
            "trend_down": {
                "allowed": true,
                "size_mult": 1.0,
                "min_strength_counter_trend": 1.5,
                "counter_trend_size_mult": 0.7
            },
            "squeeze": {
                "allowed": true,
                "size_mult": 1.1
            }
        },
        "min_hold_bars": 2,
        "failure_fade": {
            "_comment": "From configuration.json failure_fade - min_fade_strength: 0.6",
            "min_fade_strength": 0.6,
            "rejection_candle_body_ratio_max": 0.4,
            "rejection_candle_bonus_mult": 1.1,
            "min_pierce_size_pct": 0.1,
            "max_pierce_size_pct": 1.0,
            "fade_confirmation_bars": 1
        },
        "volume_capitulation": {
            "_comment": "From configuration.json - sweep_min_volume_surge: 2.0 for ICT sweeps",
            "threshold": 2.0,
            "bonus_mult": 1.15
        },
        "adx": {
            "_comment": "From configuration.json - adx_min_strength: 15",
            "min_adx_for_trend_fade": 15
        }
    },

    "ranking": {
        "_comment": "ALL values from OLD filters.json rank_* settings to match baseline ranker.py _intraday_strength()",
        "weights": {
            "volume": {
                "_comment": "rank_vol_ratio_divisor=2.0, rank_vol_cap=3.0",
                "divisor": 2.0,
                "cap": 3.0
            },
            "rsi": {
                "_comment": "rank_rsi_mid=50, rank_rsi_divisor=30, rank_rsi_floor=-0.5",
                "mid": 50.0,
                "divisor": 30.0,
                "floor": -0.5
            },
            "rsi_slope": {
                "_comment": "rank_rsi_slope_cap=0.3",
                "cap": 0.3
            },
            "adx": {
                "_comment": "rank_adx_mid=25, rank_adx_divisor=20, rank_adx_floor=-0.3",
                "mid": 25.0,
                "divisor": 20.0,
                "floor": -0.3
            },
            "adx_slope": {
                "_comment": "rank_adx_slope_cap=0.2",
                "cap": 0.2
            },
            "vwap": {
                "_comment": "rank_vwap_bonus=0.3, rank_vwap_penalty=-0.2",
                "aligned_bonus": 0.3,
                "misaligned_penalty": -0.2
            },
            "distance": {
                "_comment": "rank_dist_near_bpct=0.5, rank_dist_near_score=0.4, rank_dist_ok_bpct=1.5, rank_dist_ok_score=0.2, rank_dist_far_score=-0.1",
                "near_bpct": 0.5,
                "near_score": 0.4,
                "ok_bpct": 1.5,
                "ok_score": 0.2,
                "far_score": -0.1
            },
            "squeeze": {
                "_comment": "rank_sq_score_le_50=0.3, rank_sq_score_le_70=0.2, rank_sq_score_ge_90=-0.2",
                "low_bonus": 0.3,
                "mid_bonus": 0.2,
                "high_penalty": -0.2
            },
            "acceptance": {
                "_comment": "rank_acceptance_bonus=0.5",
                "excellent_bonus": 0.5,
                "good_bonus": 0.25
            }
        },
        "daily_trend_multipliers": {
            "aligned": 1.25,
            "counter": 0.75,
            "neutral": 1.0
        },
        "regime_multipliers": {
            "_comment": "Default fallback - Chop best for mean reversion per baseline analysis",
            "chop": 1.4,
            "squeeze": 1.2,
            "trend_up": 0.9,
            "trend_down": 0.9
        },
        "strategy_regime_multipliers": {
            "_comment": "From baseline ranker.py _get_regime_multiplier() - Strategy-specific overrides",
            "vwap_mean_reversion": {
                "_comment": "From baseline: chop=1.3, other=1.2 - VWAP strategies showed best performance",
                "chop": 1.3,
                "squeeze": 1.2,
                "trend_up": 1.2,
                "trend_down": 1.2,
                "default": 1.2
            },
            "range_deviation": {
                "_comment": "From baseline: chop=1.8, squeeze=1.5, other=1.1 - HUGE boost for institutional range trading",
                "chop": 1.8,
                "squeeze": 1.5,
                "trend_up": 1.1,
                "trend_down": 1.1,
                "default": 1.1
            },
            "range_mean_reversion": {
                "_comment": "Same as range_deviation - institutional range trading",
                "chop": 1.8,
                "squeeze": 1.5,
                "trend_up": 1.1,
                "trend_down": 1.1,
                "default": 1.1
            },
            "failure_fade": {
                "_comment": "From baseline: chop=1.2, other=1.1",
                "chop": 1.2,
                "squeeze": 1.1,
                "trend_up": 1.1,
                "trend_down": 1.1,
                "default": 1.1
            },
            "liquidity_sweep": {
                "_comment": "From baseline: chop=1.4, trend=1.1 - sweeps effective in ranging markets",
                "chop": 1.4,
                "squeeze": 1.2,
                "trend_up": 1.1,
                "trend_down": 1.1,
                "default": 1.0
            },
            "fair_value_gap": {
                "_comment": "From baseline: trend=1.3, chop=0.9 - FVGs work best in trending markets",
                "trend_up": 1.3,
                "trend_down": 1.3,
                "chop": 0.9,
                "squeeze": 1.0,
                "default": 1.0
            }
        }
    },

    "entry": {
        "_comment": "From configuration.json planner_entry_zone_fade_mult: 0.08 - Reverted to baseline for tighter mean-reversion entries",
        "zone_mult_atr": 0.08,
        "mode": "retest",
        "triggers": {
            "long": "reversal_from_low",
            "short": "reversal_from_high"
        },
        "vwap_buffer_mult": 0.2
    },

    "targets": {
        "_comment": "From configuration.json - failure_fade target_mult_t1: 1.0, t2: 2.0, vwap_mean_reversion t1: 1.0, t2: 1.5",
        "vwap_based": {
            "_comment": "VWAP reversion targets based on distance to VWAP",
            "t1_frac": 0.5,
            "t2_frac": 1.0,
            "t3_frac": 1.3
        },
        "fallback_rr_ratios": {
            "_comment": "From configuration.json failure_fade - target_mult_t1: 1.0, target_mult_t2: 2.0",
            "t1": 1.0,
            "t2": 2.0,
            "t3": 2.5
        },
        "qty_splits": {
            "_comment": "60-40 split to match OLD config - T3 disabled (0%)",
            "t1": 0.60,
            "t2": 0.40,
            "t3": 0.0
        },
        "trail": {
            "after_t1": {
                "move_sl_to": "breakeven",
                "offset_atr": 0.0
            },
            "after_t2": {
                "move_sl_to": "t1",
                "offset_atr": 0.05
            }
        }
    },

    "stop_loss": {
        "_comment": "From baseline configuration.json (commit 3ded63d) - sl_atr_mult: 2.0 (failure_fade setup-specific stop_mult: 1.5 is handled at setup level)",
        "atr_multiplier": 2.0,
        "min_stop_distance_pct": 0.5
    },

    "rsi_penalty": {
        "_comment": "REVERSION: Penalize neutral RSI (35-65) - need extreme exhaustion",
        "neutral_low": 35,
        "neutral_high": 65,
        "penalty_mult": 0.85
    }
}
