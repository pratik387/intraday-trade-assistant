{
    "_comment": "MOMENTUM Pipeline Configuration - Values from configuration.json verified against pro Indian trading research",
    "_category": "MOMENTUM",
    "_description": "Trend continuation plays (trend pullback, trend continuation, momentum breakout)",

    "setup_types": [
        "trend_continuation_long", "trend_continuation_short",
        "trend_pullback_long", "trend_pullback_short",
        "trend_reversal_long", "trend_reversal_short",
        "momentum_trend_long", "momentum_trend_short",
        "momentum_breakout_long", "momentum_breakout_short",
        "flag_continuation_long", "flag_continuation_short"
    ],
    "_note_squeeze_release": "squeeze_release belongs to BREAKOUT category (see setup_categories.py)",

    "screening": {
        "_comment": "Category-specific screening filters - DISABLED for A/B baseline",
        "enabled": false,
        "time_windows": {
            "_comment": "From configuration.json time_policy + research: best momentum 09:15-10:15, golden hour 14:30-15:30",
            "morning_start": "09:15",
            "morning_end": "11:00",
            "avoid_window_start": "11:00",
            "avoid_window_end": "12:00",
            "afternoon_start": "13:00",
            "afternoon_end": "14:45",
            "golden_hour_start": "14:30",
            "golden_hour_end": "15:30",
            "last_entry_cutoff": "14:45"
        },
        "adx": {
            "_comment": "Research: ADX 15-25 for trend confirmation, 25+ for strong trend",
            "min_value": 20,
            "strong_trend_threshold": 25
        },
        "ema_alignment": {
            "required": true
        },
        "momentum_thresholds": {
            "_comment": "From configuration.json momentum_breakout - min_momentum_3bar_pct: 0.8, professional NSE range 0.5-1.5%",
            "min_momentum_1bar_pct": 0.3,
            "min_momentum_2bar_pct": 0.6,
            "min_momentum_3bar_pct": 0.8
        }
    },

    "quality": {
        "_comment": "ALIGNED TO BASELINE: min_t1_rr: 1.2 from configuration.json",
        "min_structural_rr": 1.2,
        "adx_score": {
            "_comment": "Research: ADX 25+ for strong trend",
            "base": 25,
            "cap": 2.0
        },
        "ema_alignment_scores": {
            "long": {
                "price_above_ema20_above_ema50": 1.0,
                "price_above_ema20": 0.7,
                "ema20_above_ema50": 0.5,
                "counter_trend": 0.3
            },
            "short": {
                "price_below_ema20_below_ema50": 1.0,
                "price_below_ema20": 0.7,
                "ema20_below_ema50": 0.5,
                "counter_trend": 0.3
            }
        },
        "quality_multiplier": 2.0,
        "quality_thresholds": {
            "excellent": {
                "_comment": "Research: ADX 25+ for strong trend",
                "min_adx": 30,
                "min_ema_aligned": 0.9
            },
            "good": {
                "min_adx": 25,
                "min_ema_aligned": 0.5
            },
            "fair": {
                "min_adx": 20,
                "min_ema_aligned": 0.0
            }
        }
    },

    "gates": {
        "_comment": "From configuration.json trend_continuation - min_trend_strength: 1.2, min_volume_mult: 1.3",
        "_ab_baseline_comment": "DISABLED regime blocking and ADX gates for A/B baseline",
        "regime_rules": {
            "enabled": false,
            "chop": {
                "allowed": true,
                "reason": "DISABLED for A/B baseline"
            },
            "trend_up": {
                "allowed": true,
                "size_mult": 1.3,
                "aligned_bonus": 1.2
            },
            "trend_down": {
                "allowed": true,
                "size_mult": 1.3,
                "aligned_bonus": 1.2
            },
            "squeeze": {
                "_comment": "Squeeze setup best for squeeze_release",
                "allowed": true,
                "size_mult": 0.8
            }
        },
        "adx": {
            "_comment": "From configuration.json - adx_min_trend: 20 - DISABLED for A/B baseline",
            "enabled": false,
            "min_value": 20,
            "block_below": false,
            "strong_threshold": 30,
            "strong_bonus_mult": 1.1
        },
        "trend_alignment": {
            "_comment": "From configuration.json - aligned trading - DISABLED for A/B baseline",
            "enabled": false,
            "aligned_size_mult": 1.2,
            "counter_trend_size_mult": 0.7
        },
        "volume": {
            "_comment": "From configuration.json trend_continuation - min_volume_mult: 1.3",
            "min_volume_mult": 1.3
        },
        "trend_strength": {
            "_comment": "From configuration.json trend_continuation - min_trend_strength: 1.2",
            "min_trend_strength": 1.2
        },
        "pullback": {
            "_comment": "From configuration.json trend_continuation - min_pullback_pct: 0.3, max_pullback_pct: 5.0",
            "min_pullback_pct": 0.3,
            "max_pullback_pct": 5.0
        },
        "flag_continuation": {
            "_comment": "From configuration.json flag_continuation - min_consolidation_bars: 3, max: 12",
            "min_consolidation_bars": 3,
            "max_consolidation_bars": 12,
            "min_trend_strength": 1.5,
            "trend_lookback_period": 10,
            "max_consolidation_range_pct": 2.0
        },
        "squeeze_release": {
            "_comment": "From configuration.json squeeze_release - width_window: 12, expansion_ratio: 1.5",
            "width_window": 12,
            "expansion_ratio": 1.5,
            "width_calculation_period": 20,
            "recent_width_bars": 5
        },
        "validated_filters": {
            "_comment": "DISABLED - 1-Year A/B Testing Baseline (NOTE: This section is legacy/unused in code)",
            "momentum_breakout_long_volume": {
                "enabled": false,
                "min_volume": 100000,
                "_evidence": "DISABLED for A/B baseline"
            },
            "long_trade_volume": {
                "enabled": false,
                "min_volume": 150000,
                "_evidence": "DISABLED for A/B baseline"
            }
        },
        "long_specific_filters": {
            "_comment": "DATA-DRIVEN (Dec 2024): Filters specific to long trades based on winner/loser analysis",
            "rsi_max": {
                "threshold": 65,
                "_evidence": "RSI>=70: 9.3% WR (7W/75T). RSI<60: 16.4% WR (32W/195T). High RSI = chasing exhausted moves."
            },
            "entry_time_cutoff": {
                "last_entry_hour": 11,
                "last_entry_minute": 30,
                "_evidence": "09:15-11:00: 19% WR. 11:00-12:00: 11% WR. 13:00+: 7.7% WR. After 14:00: 0% WR."
            },
            "squeeze_regime_boost": {
                "size_mult": 1.3,
                "_evidence": "55.6% of winning longs came from squeeze regime vs only 20% from trend_up."
            },
            "max_hold_minutes": {
                "enabled": true,
                "limit": 120,
                "_evidence": "Pro traders hold 30-90 min max. After 2 hours, momentum fades. Time-based exit if no T1 hit."
            }
        },
        "setup_filters": {
            "_comment": "DEEP DIVE FILTERS - 1-Year Backtest Analysis (72,042 trades, 231 sessions)",
            "_active_profile": "HOUR_OPTIMIZED_FILTERS",
            "_analysis_date": "2026-01-02",
            "_analysis_source": "Deep dive analysis with ALL parameters: cap, regime, hour, 2D/3D combinations",
            "_note_squeeze_release": "squeeze_release filters are in breakout_config.json (correct category)",
            "_note_momentum_breakout": "MOVED TO breakout_config.json - momentum_breakout belongs to BREAKOUT pipeline",
            "_note_flag_continuation": "MOVED TO breakout_config.json - flag_continuation belongs to BREAKOUT pipeline",
            "trend_continuation_long": {
                "enabled": true,
                "blocked_entirely": false,
                "allowed_caps": ["large_cap"],
                "allowed_regimes": ["squeeze"],
                "blocked_regimes": ["chop", "trend_up", "trend_down"],
                "allowed_hours": [14, 15],
                "blocked_hours": [10, 11, 12, 13],
                "_evidence": "DEEP DIVE: large_cap+14: Rs 438, 90% WR | large_cap+15: Rs 295, 87.5% WR | squeeze+14: Rs 264, 80% WR | 10-13 ALL LOSE"
            },
            "trend_continuation_short": {
                "enabled": true,
                "blocked_entirely": false,
                "allowed_caps": ["large_cap", "mid_cap"],
                "allowed_regimes": ["trend_down", "squeeze"],
                "blocked_regimes": ["chop", "trend_up"],
                "allowed_hours": [13, 14, 15],
                "blocked_hours": [10, 11, 12],
                "_evidence": "DEEP DIVE: large_cap+trend_down: Rs 213, 83.3% WR | mid_cap+13: Rs 290, 84.6% WR | 10-12 LOSE Rs 93k"
            },
            "trend_pullback_long": {
                "enabled": true,
                "blocked_entirely": true,
                "_evidence": "BLOCKED: -Rs 65,000 total PnL - globally blocked in base_config"
            },
            "trend_pullback_short": {
                "enabled": false,
                "_evidence": "Needs further analysis - keep disabled"
            },
            "_flag_continuation_REMOVED": "Moved to breakout_config.json - flag_continuation belongs to BREAKOUT pipeline"
        },
        "global_filters": {
            "_comment": "UNIFIED GLOBAL FILTERS - Applied to all setups before setup-specific filters",
            "short_min_adx": {
                "enabled": false,
                "min_adx": 25,
                "_rationale": "Shorts need stronger trend confirmation"
            },
            "long_min_volume": {
                "enabled": false,
                "min_volume": 150000,
                "_rationale": "Longs need minimum institutional volume"
            },
            "rsi_dead_zone": {
                "enabled": false,
                "min_rsi": 45,
                "max_rsi": 55,
                "_rationale": "Disabled for momentum - trend continuation needs momentum"
            }
        }
    },

    "ranking": {
        "_comment": "MOMENTUM-SPECIFIC RANKING (Dec 2024) - Pro trader research: high ADX, directional RSI, VWAP aligned critical",
        "mode": "momentum_specific",
        "score_scale": 5.0,
        "_score_scale_note": "Multiplier to scale weighted sum back to usable range (~0-5). Weighted sum alone produces ~0.17 mean.",
        "weights": {
            "volume": {
                "_comment": "CRITICAL for momentum - confirms institutional participation",
                "divisor": 2.0,
                "cap": 2.0,
                "weight": 0.20
            },
            "rsi": {
                "_comment": "DIRECTIONAL = GOOD for momentum (RSI confirms trend direction)",
                "mode": "directional_is_good",
                "long_bullish_threshold": 55,
                "long_strong_bullish_threshold": 60,
                "long_overbought_threshold": 75,
                "short_bearish_threshold": 45,
                "short_strong_bearish_threshold": 40,
                "short_oversold_threshold": 25,
                "strong_bonus": 0.5,
                "good_bonus": 0.3,
                "penalty": -0.3,
                "weight": 0.15
            },
            "adx": {
                "_comment": "HIGH ADX = GOOD for momentum (strong trend needed)",
                "mode": "high_is_good",
                "strong_threshold": 35,
                "good_threshold": 25,
                "weak_threshold": 20,
                "strong_bonus": 0.5,
                "good_bonus": 0.3,
                "weak_penalty": -0.4,
                "weight": 0.25
            },
            "vwap": {
                "_comment": "ALIGNED = CRITICAL for momentum (riding the wave)",
                "mode": "aligned_required",
                "aligned_bonus": 0.5,
                "misaligned_penalty": -0.4,
                "weight": 0.15
            },
            "distance": {
                "_comment": "Less critical for momentum - already trending",
                "near_bpct": 0.5,
                "near_score": 0.2,
                "ok_bpct": 1.5,
                "ok_score": 0.1,
                "far_score": 0.0,
                "weight": 0.05
            },
            "squeeze": {
                "_comment": "High squeeze = good for momentum (pent-up energy)",
                "low_bonus": 0.2,
                "mid_bonus": 0.3,
                "high_bonus": 0.4,
                "weight": 0.10
            },
            "acceptance": {
                "_comment": "KEEP for momentum - R:R matters",
                "enabled": true,
                "excellent_bonus": 0.4,
                "good_bonus": 0.2,
                "weight": 0.10
            }
        },
        "regime_multipliers": {
            "_comment": "Default fallback - Trend regimes best for momentum",
            "trend_up": 1.5,
            "trend_down": 1.5,
            "squeeze": 0.8,
            "chop": 0.5
        },
        "strategy_regime_multipliers": {
            "_comment": "From baseline ranker.py _get_regime_multiplier() - Strategy-specific overrides",
            "trend_continuation": {
                "_comment": "From baseline: trend=1.5, other=1.1 - Excellent for following established trends",
                "trend_up": 1.5,
                "trend_down": 1.5,
                "squeeze": 1.1,
                "chop": 1.1,
                "default": 1.1
            },
            "trend_pullback": {
                "trend_up": 1.4,
                "trend_down": 1.4,
                "squeeze": 1.1,
                "chop": 1.0,
                "default": 1.1
            },
            "trend_reversal": {
                "_comment": "Reversal plays - need strong trend to reverse from",
                "trend_up": 1.3,
                "trend_down": 1.3,
                "squeeze": 1.0,
                "chop": 0.9,
                "default": 1.0
            },
            "momentum_trend": {
                "trend_up": 1.4,
                "trend_down": 1.4,
                "squeeze": 1.0,
                "chop": 0.8,
                "default": 1.1
            },
            "momentum_breakout": {
                "_comment": "From baseline: trend=1.4, chop=1.3, other=1.2",
                "trend_up": 1.4,
                "trend_down": 1.4,
                "chop": 1.3,
                "squeeze": 1.2,
                "default": 1.2
            },
            "flag_continuation": {
                "_comment": "Flag patterns work best in trending markets",
                "trend_up": 1.4,
                "trend_down": 1.4,
                "squeeze": 1.2,
                "chop": 1.1,
                "default": 1.1
            },
            "squeeze_release": {
                "_comment": "Squeeze release best in squeeze regime (by definition)",
                "squeeze": 1.5,
                "chop": 1.3,
                "trend_up": 1.2,
                "trend_down": 1.2,
                "default": 1.1
            }
        },
        "daily_trend_multipliers": {
            "aligned": 1.4,
            "counter": 0.6,
            "neutral": 1.0
        }
    },

    "entry": {
        "_comment": "WIDENED (Dec 2024): 0.25->0.4 ATR, added min_zone_pct. momentum_breakout_long had 0.26% zones -> 50% trigger rate.",
        "zone_mult_atr": 0.4,
        "min_zone_pct": 0.25,
        "mode": "retest",
        "triggers": {
            "long": "hold_above_ema20",
            "short": "hold_below_ema20"
        },
        "reference": "ema20"
    },

    "targets": {
        "_comment": "DATA-DRIVEN (Dec 2024): Long avg MFE=0.74R. Lowered T1 for longs. trend_continuation already has 1.0R T1.",
        "rr_ratios": {
            "trend_continuation": {
                "t1": 1.0,
                "t2": 2.0,
                "t3": 3.0
            },
            "momentum_breakout": {
                "_comment": "LONG-SPECIFIC: momentum_breakout_long had 0% T1 hit at 1.5R. Lower to 1.0R for longs.",
                "long": {"t1": 1.0, "t2": 2.0, "t3": 3.0},
                "short": {"t1": 1.5, "t2": 2.5, "t3": 3.5},
                "t1": 1.5,
                "t2": 2.5,
                "t3": 3.5
            },
            "flag_continuation": {
                "t1": 1.5,
                "t2": 2.5,
                "t3": 3.5
            },
            "squeeze_release": {
                "t1": 1.5,
                "t2": 2.5,
                "t3": 3.5
            },
            "default": {
                "long": {"t1": 1.0, "t2": 2.0, "t3": 3.0, "_comment": "Lower T1 for all longs"},
                "short": {"t1": 1.5, "t2": 3.0, "t3": 5.0},
                "t1": 1.5,
                "t2": 3.0,
                "t3": 5.0
            }
        },
        "qty_splits": {
            "_comment": "70-30 split - DATA-DRIVEN: Higher T1 exit due to high hard SL rate (~41%)",
            "t1": 0.70,
            "t2": 0.30,
            "t3": 0.0
        },
        "caps": {
            "_comment": "FIXED: max_pct was 1.0 (1%) - way too restrictive! Old config uses 100%. Targets need to reach 2-3R for positive expectancy.",
            "t1": {
                "measured_move_frac": 2.0,
                "max_pct": 100.0
            },
            "t2": {
                "measured_move_frac": 3.0,
                "max_pct": 100.0
            },
            "t3": {
                "measured_move_frac": 4.0,
                "max_pct": 100.0
            }
        },
        "trail": {
            "after_t1": {
                "move_sl_to": "entry",
                "offset_atr": 0.1
            },
            "after_t2": {
                "move_sl_to": "t1",
                "offset_atr": 0.0
            },
            "trailing": {
                "enable_after_t1": true,
                "trail_atr": 1.5
            }
        }
    },

    "stop_loss": {
        "_comment": "From baseline configuration.json (commit 3ded63d) - sl_atr_mult: 2.0",
        "atr_multiplier": 2.0,
        "trend_continuation_mult": 0.75,
        "min_stop_distance_pct": 0.5
    },

    "rsi_penalty": {
        "_comment": "MOMENTUM: Penalize weak momentum (low RSI for longs, high RSI for shorts)",
        "long_weak_threshold": 40,
        "short_weak_threshold": 60,
        "penalty_mult": 0.9
    }
}
