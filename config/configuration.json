{
  "k_atr": 0.2,
  "min_breakout_atr_mult": 0.3,
  "hold_bars": 1,
  "vol_z_required": 0.8,
  "width_window": 40,
  "expansion_ratio": 1.3,
  "expiry_size_multiplier": 0.7,
  "expiry_allow_breakout": false,
  "expiry_allow_fade": true,
  "regime_scores": {
    "squeeze": 0.6,
    "trend": 0.8,
    "chop": 0.5
  },
  "regime_thresholds": {
    "vwap_min_strength": 2.0,
    "vwap_min_adx": 8.0,
    "vwap_min_vol_mult": 1.05,
    "bo_min_adx": 12.0,
    "bo_min_vol_mult": 1.15,
    "ff_min_vol_mult": 0.9,
    "long_max_ema_distance_pct": 0.12
  },
  "ict_quality_filters": {
    "_comment": "PROFESSIONAL ICT - Context over metrics (2025-11-18 - Full Professional Implementation)",
    "_rationale": "Professional ICT requires sweep OR MSS (context), 2.0x volume (institutional), at structure levels. Old 1.1x volume produced 0 trades.",
    "order_block": {
      "min_block_size_pct": 0.0005,
      "_size_comment": "Size less important with sweep/MSS validation",
      "min_volume_ratio": 2.0,
      "_volume_comment": "PROFESSIONAL: 2.0x = institutional standard (hardcoded in detection, not configurable anymore)",
      "swing_tolerance_pct": 0.15,
      "_swing_comment": "At swing structure (15% tolerance for NSE volatility)",
      "min_rejection_wick_pct": 0.1,
      "_wick_comment": "Rejection confirmation (10% minimum)"
    },
    "fair_value_gap": {
      "min_gap_size_pct": 0.0005,
      "_gap_comment": "Clean gap matters, not size",
      "min_volume_ratio": 1.2,
      "_fvg_volume_comment": "RELAXED (Dec 2024): 1.5->1.2 - only 1 detection in 6 months with 1.5x",
      "max_wick_penetration_pct": 0.3,
      "_penetration_comment": "RELAXED: Allow wick penetration (30% max, was 25%)",
      "vwap_distance_tolerance_pct": 0.25,
      "_vwap_comment": "RELAXED (Dec 2024): 0.15->0.25 - allow FVG further from VWAP",
      "swing_tolerance_pct": 0.25,
      "_swing_comment": "RELAXED (Dec 2024): 0.15->0.25 - allow FVG further from swing"
    }
  },
  "liquidity_gates": {
    "_comment": "Market Cap Segmentation - Priority 1: Liquidity Filters (evidence-based thresholds)",
    "enabled": true,
    "exclude_micro_caps": false,
    "_rationale_micro_caps": "ENABLED per 3-month baseline analysis: micro-caps generated 84% of profits (Rs.5,550 out of Rs.6,617). failure_fade strategy excels in volatile, illiquid names.",
    "large_cap": {
      "min_mcap_cr": 20000,
      "min_avg_volume_daily": 100000,
      "min_value_traded_cr_daily": 1.0,
      "volume_surge_min": 1.3,
      "_rationale": "Liquid names - lower volume requirements due to deep order books"
    },
    "mid_cap": {
      "min_mcap_cr": 5000,
      "max_mcap_cr": 20000,
      "min_avg_volume_daily": 250000,
      "min_value_traded_cr_daily": 0.5,
      "volume_surge_min": 2.0,
      "_rationale": "Need 2x volume confirmation vs large-cap to avoid manipulation"
    },
    "small_cap": {
      "min_mcap_cr": 500,
      "max_mcap_cr": 5000,
      "min_avg_volume_daily": 500000,
      "min_value_traded_cr_daily": 0.3,
      "volume_surge_min": 3.0,
      "max_bid_ask_spread_bps": 20,
      "_rationale": "Strict filters - 3x volume surge required to avoid false breakouts (institutional standard)"
    },
    "micro_cap": {
      "min_mcap_cr": 50,
      "max_mcap_cr": 500,
      "min_avg_volume_daily": 750000,
      "min_value_traded_cr_daily": 0.2,
      "volume_surge_min": 4.0,
      "max_bid_ask_spread_bps": 40,
      "_rationale": "STRICTEST filters - 4x volume surge (vs 3x small-caps) to ensure tradeable liquidity. Baseline data: 43.8% WR, 1.63 PF, Rs.173/trade avg."
    }
  },
  "cap_strategy_preferences": {
    "_comment": "Market Cap Segmentation - Priority 2: Strategy-Cap Mapping (institutional evidence)",
    "enabled": true,
    "large_cap": {
      "preferred": [
        "vwap_mean_reversion_long",
        "vwap_mean_reversion_short",
        "failure_fade_long",
        "failure_fade_short",
        "range_rejection_long",
        "range_rejection_short"
      ],
      "allowed": [
        "breakout_long",
        "breakout_short",
        "trend_pullback_long",
        "trend_pullback_short",
        "gap_fill_long",
        "gap_fill_short",
        "orb_breakout_long",
        "orb_breakout_short"
      ],
      "blocked": [
        "momentum_breakout_long",
        "momentum_breakout_short"
      ],
      "_rationale": "Large-caps mean-revert reliably (70% WR), move slowly on momentum. Institutional HFT keeps prices efficient."
    },
    "mid_cap": {
      "preferred": [
        "orb_breakout_long",
        "orb_breakout_short",
        "flag_continuation_long",
        "flag_continuation_short",
        "trend_pullback_long",
        "trend_pullback_short"
      ],
      "allowed": [
        "gap_fill_long",
        "gap_fill_short",
        "vwap_reclaim_long",
        "vwap_lose_short",
        "breakout_long",
        "breakout_short",
        "vwap_mean_reversion_long",
        "vwap_mean_reversion_short",
        "failure_fade_long",
        "failure_fade_short"
      ],
      "blocked": [],
      "_rationale": "Mid-caps: best balance of momentum + structure. All strategies viable."
    },
    "small_cap": {
      "preferred": [
        "momentum_breakout_long",
        "momentum_breakout_short",
        "orb_breakout_long",
        "orb_breakout_short",
        "squeeze_release_long",
        "squeeze_release_short"
      ],
      "allowed": [
        "gap_fill_long",
        "gap_fill_short",
        "breakout_long",
        "breakout_short",
        "flag_continuation_long",
        "flag_continuation_short"
      ],
      "blocked": [
        "vwap_mean_reversion_long",
        "vwap_mean_reversion_short",
        "failure_fade_long",
        "failure_fade_short"
      ],
      "_rationale": "Small-caps momentum-driven (2-3x faster moves). Mean-reversion unreliable due to low liquidity + manipulation risk."
    },
    "micro_cap": {
      "preferred": [
        "failure_fade_long",
        "failure_fade_short",
        "volume_spike_reversal_long",
        "volume_spike_reversal_short"
      ],
      "allowed": [
        "orb_breakout_long",
        "orb_breakout_short",
        "squeeze_release_long",
        "squeeze_release_short",
        "momentum_breakout_long",
        "momentum_breakout_short"
      ],
      "blocked": [
        "vwap_mean_reversion_long",
        "vwap_mean_reversion_short",
        "trend_pullback_long",
        "trend_pullback_short",
        "range_rejection_long",
        "range_rejection_short"
      ],
      "_rationale": "BASELINE PROVEN: 43.8% WR, 1.63 PF, Rs.173/trade (best segment!). failure_fade strategy DOMINATES micro-caps due to high volatility + retail-driven failed breakouts. Avoid range/pullback strategies (too choppy)."
    }
  },
  "cap_risk_adjustments": {
    "_comment": "Market Cap Segmentation - Priority 3: Risk Sizing by Cap (Van Tharp evidence)",
    "enabled": true,
    "large_cap": {
      "size_multiplier": 1.2,
      "max_position_pct": 5.0,
      "sl_atr_multiplier": 1.5,
      "_rationale": "REVERTED from 2.0x to 1.5x - wider stops were causing 800+ Rs losses"
    },
    "mid_cap": {
      "size_multiplier": 1.0,
      "max_position_pct": 3.0,
      "sl_atr_multiplier": 1.5,
      "_rationale": "REVERTED from 2.0x to 1.5x - wider stops were causing 800+ Rs losses"
    },
    "small_cap": {
      "size_multiplier": 0.6,
      "max_position_pct": 2.0,
      "sl_atr_multiplier": 1.7,
      "_rationale": "REVERTED from 2.0x to 1.7x - wider stops were causing 800+ Rs losses"
    },
    "micro_cap": {
      "size_multiplier": 0.5,
      "max_position_pct": 1.5,
      "sl_atr_multiplier": 1.8,
      "_rationale": "REVERTED from 2.0x to 1.8x - wider stops were causing 800+ Rs losses"
    }
  },
  "regime_cap_allocation": {
    "_comment": "Market Cap Segmentation - Priority 4: Regime-Cap Interaction (institutional rotation + baseline data)",
    "enabled": true,
    "chop": {
      "large_cap_weight": 0.5,
      "mid_cap_weight": 0.15,
      "small_cap_weight": 0.1,
      "micro_cap_weight": 0.25,
      "_rationale": "CHOP \u00e2\u2020\u2019 Large-caps + micro-caps excel (mean-reversion edge). Micro-caps 25% weight due to BASELINE: 43.8% WR, 1.63 PF with failure_fade strategy in chop conditions."
    },
    "trend_up": {
      "large_cap_weight": 0.15,
      "mid_cap_weight": 0.45,
      "small_cap_weight": 0.25,
      "micro_cap_weight": 0.15,
      "_rationale": "TREND_UP \u00e2\u2020\u2019 Mid/Small-caps lead momentum. Micro-caps 15% (moderate allocation, prefer liquidity in trends)."
    },
    "trend_down": {
      "large_cap_weight": 0.5,
      "mid_cap_weight": 0.25,
      "small_cap_weight": 0.15,
      "micro_cap_weight": 0.1,
      "_rationale": "TREND_DOWN \u00e2\u2020\u2019 Flight to quality, minimize micro-cap exposure. Micro-caps 10% (lowest allocation due to crash risk)."
    },
    "squeeze": {
      "large_cap_weight": 0.35,
      "mid_cap_weight": 0.3,
      "small_cap_weight": 0.2,
      "micro_cap_weight": 0.15,
      "_rationale": "SQUEEZE \u00e2\u2020\u2019 Balanced allocation awaiting breakout direction. Micro-caps 15% (moderate, can explode either way)."
    },
    "_institutional_evidence": "Linda Raschke: market cap rotation patterns follow regime shifts. CTAs rotate from large\u00e2\u2020\u2019mid\u00e2\u2020\u2019small during trend, reverse during chop.",
    "_baseline_evidence": "3-month baseline: micro-caps generated 84% of profits (Rs.5,550 / Rs.6,617 total). failure_fade strategy dominates micro-caps in CHOP conditions."
  },
  "decision_require_structure_event": true,
  "news_min_hold_bars": 2,
  "bar_1m_freq": "1min",
  "bar_5m_freq": "5min",
  "bar_5m_span_minutes": 5,
  "ws_subscribe_batch_ms": 1500,
  "ws_max_batch_size": 100,
  "ws_flush_thread_enabled": true,
  "ws_flush_interval_ms": 500,
  "ws_max_retries": 5,
  "ws_reconnect_backoff_secs": 2,
  "submgr_debounce_ms": 1500,
  "router_timestamp_fields": [
    "timestamp",
    "exchange_timestamp",
    "last_trade_time",
    "ts"
  ],
  "router_symbol_fields": [
    "symbol",
    "tradingsymbol"
  ],
  "router_price_fields": [
    "ltp",
    "price",
    "last_price"
  ],
  "router_tradeqty_fields": [
    "last_trade_qty",
    "qty"
  ],
  "router_dayvolume_fields": [
    "volume",
    "total_volume_traded"
  ],
  "router_default_timezone": "Asia/Kolkata",
  "router_assume_epoch_utc": true,
  "order_max_per_sec": 8,
  "order_max_per_min": 180,
  "order_max_per_day": 3000,
  "order_loop_idle_ms": 10,
  "order_retry_delay_ms": 50,
  "order_exception_delay_ms": 100,
  "scan_min_bars_5m": 30,
  "scan_ret1_min": 0.002,
  "scan_ret3_min": 0.004,
  "scan_ret5_min": 0.006,
  "scan_vol_z_window": 20,
  "scan_vol_z_min": 0.5,
  "scan_vwap_dist_bps_max": 80,
  "scan_output_max_rows": 50,
  "session_open_hhmm": "0915",
  "session_close_hhmm": "1530",
  "orb_minutes": 15,
  "planner_atr_period": 14,
  "planner_choppiness_lookback": 30,
  "planner_choppiness_high": 61.8,
  "planner_choppiness_low": 38.2,
  "planner_max_gap_pct_for_trend": 3.0,
  "planner_entry_zone_atr_frac": 0.08,
  "_comment_entry_zone": "STRATEGY-SPECIFIC ENTRY ZONES: Breakout fix applied - wider zones for momentum continuation",
  "planner_entry_zone_breakout_mult": 0.25,
  "_comment_breakout_mult": "Breakout strategies: 0.25 ATR (3x wider for momentum). NOTE: Immediate execution enabled, zone used for fallback only.",
  "planner_entry_zone_fade_mult": 0.08,
  "_comment_fade_mult": "Failure fade strategies: 0.08 ATR (proven optimal with 35% trigger rate)",
  "planner_entry_zone_default_mult": 0.15,
  "_comment_default_mult": "Other strategies: 0.15 ATR (reverted from 0.25 - wider zones caused T1+ rate drop from 26% to 21% and avg T1+ PnL crash from Rs.684 to Rs.136)",
  "planner_vwap_reclaim_min_bars_above": 3,
  "_comment_breakout_execution": "PHASE 1 FIX: Breakout immediate execution (professional standard)",
  "breakout_immediate_execution": true,
  "_comment_immediate": "True = Execute immediately on decision (no entry zone wait). Fixes 8-minute delay issue.",
  "breakout_volume_surge_min": 1.5,
  "_comment_volume_surge": "PHASE 4 REVERT: Back to 1.5x (TypeError fix resolved the 3.2% trigger issue, not filter strictness). Professional standard for volume confirmation.",
  "breakout_momentum_candle_min_ratio": 2.0,
  "_comment_momentum_candle": "PHASE 4 REVERT: Back to 2.0x - stricter filter for candle size ensures quality breakouts. TypeError was the real blocker, not this threshold.",
  "breakout_volume_surge_min_short": 2.0,
  "_comment_volume_short": "PHASE 4 REVERT: Back to 2.0x for shorts - short breakouts need stronger volume confirmation (institutional standard).",
  "breakout_momentum_candle_min_ratio_short": 2.5,
  "_comment_momentum_short": "PHASE 4 REVERT: Back to 2.5x for shorts - short breakouts require larger candles to avoid false breakdowns.",
  "risk_per_trade_rupees": 1000.0,
  "fees_slippage_bps": 5.0,
  "fill_quality": {
    "enabled": true,
    "min_rr_to_t1": 0.5,
    "max_slippage_pct": 0.5,
    "_comment": "Reject fills that compress R:R below 0.5 or slip > 0.5%. Exit immediately on rejection."
  },
  "enable_lunch_pause": true,
  "lunch_start": "12:15",
  "lunch_end": "13:15",
  "setups": {
    "breakout_long": {
      "enabled": true,
      "_comment": "Generic breakout_long - uses same params as level_breakout_long",
      "k_atr": 0.15,
      "min_breakout_atr_mult": 0.2,
      "hold_bars": 1,
      "vol_z_required": 1.0,
      "require_breakout_bar_volume_surge": true,
      "breakout_volume_min_ratio": 1.3,
      "enable_smc_filtering": true,
      "liquidity_grab_tolerance_pct": 0.3,
      "sl_atr_multiplier": 2.0,
      "min_stop_distance_pct": 0.3,
      "target_mult_t1": 2.0,
      "target_mult_t2": 3.0,
      "confidence_strong_breakout": 0.85,
      "confidence_weak_breakout": 0.65,
      "entry_mode": "immediate",
      "aggressive_min_volume_z": 1.8,
      "aggressive_min_conviction": 0.7,
      "retest_entry_zone_width_atr": 0.5,
      "retest_timeout_minutes": 30,
      "allow_both_modes": true
    },
    "breakout_short": {
      "enabled": false,
      "_comment": "PHASE 1 UPDATE: Disabled per 6-month baseline analysis. 22 trades, 36.4% WR, -Rs.1,299 cumulative loss.",
      "k_atr": 0.15,
      "min_breakout_atr_mult": 0.2,
      "hold_bars": 1,
      "vol_z_required": 1.0,
      "require_breakout_bar_volume_surge": true,
      "breakout_volume_min_ratio": 1.3,
      "enable_smc_filtering": true,
      "liquidity_grab_tolerance_pct": 0.3,
      "sl_atr_multiplier": 2.0,
      "min_stop_distance_pct": 0.3,
      "target_mult_t1": 2.0,
      "target_mult_t2": 3.0,
      "confidence_strong_breakout": 0.85,
      "confidence_weak_breakout": 0.65,
      "entry_mode": "immediate",
      "aggressive_min_volume_z": 1.8,
      "aggressive_min_conviction": 0.7,
      "retest_entry_zone_width_atr": 0.5,
      "retest_timeout_minutes": 30,
      "allow_both_modes": true
    },
    "vwap_reclaim_long": {
      "enabled": true,
      "min_distance_bps": 30,
      "_comment_min": "VWAP OPTIMIZATION: 50 \u2192 30 bps (0.30%) - Trend continuation needs tighter entry, allow early momentum capture. Professional standard for reclaim setups.",
      "max_distance_bps": 200,
      "_comment_max": "VWAP OPTIMIZATION: 300 \u2192 200 bps (2.00%) - Beyond 2% = exhaustion/reversal risk. Tighter than mean reversion (150) as trend continuation needs more runway, but cap excessive stretch.",
      "require_oversold_rsi": false,
      "oversold_rsi_threshold": 30,
      "overbought_rsi_threshold": 70,
      "min_bars_above_vwap": 3,
      "reclaim_volume_confirmation": true,
      "min_volume_mult": 1.5,
      "_comment_volume": "VWAP OPTIMIZATION: 1.3 \u2192 1.5x - Professional institutional volume confirmation threshold (Tier 1 filter). Entry timing, not pre-filter.",
      "reclaim_lookback_bars": 12,
      "max_bars_above_for_reclaim": 8,
      "_comment_freshness": "Fresh reclaim detection: must have been below VWAP in last 12 bars, above for max 8 bars",
      "min_stop_distance_pct": 0.5,
      "stop_distance_mult": 0.75,
      "vwap_buffer_mult": 0.15,
      "target_mult_t1": 1.2,
      "target_mult_t2": 2.0,
      "confidence_strong_signal": 0.85,
      "confidence_weak_signal": 0.65
    },
    "vwap_lose_short": {
      "enabled": true,
      "min_distance_bps": 30,
      "_comment_min": "VWAP OPTIMIZATION: 50 \u2192 30 bps (0.30%) - Trend reversal needs tight entry at VWAP loss. Symmetrical to vwap_reclaim_long.",
      "max_distance_bps": 200,
      "_comment_max": "VWAP OPTIMIZATION: 300 \u2192 200 bps (2.00%) - Beyond 2% = excessive stretch, may reverse back up. Cap downside exhaustion.",
      "require_oversold_rsi": false,
      "oversold_rsi_threshold": 30,
      "overbought_rsi_threshold": 70,
      "min_bars_above_vwap": 2,
      "reclaim_volume_confirmation": true,
      "min_volume_mult": 1.5,
      "_comment_volume": "VWAP OPTIMIZATION: 1.3 \u2192 1.5x - Professional institutional volume confirmation threshold (Tier 1 filter). Entry confirmation, not pre-filter.",
      "lose_lookback_bars": 12,
      "max_bars_below_for_lose": 8,
      "_comment_freshness": "Fresh lose detection: must have been above VWAP in last 12 bars, below for max 8 bars",
      "min_stop_distance_pct": 0.5,
      "stop_distance_mult": 0.75,
      "vwap_buffer_mult": 0.15,
      "target_mult_t1": 1.2,
      "target_mult_t2": 2.0,
      "confidence_strong_signal": 0.8,
      "confidence_weak_signal": 0.6
    },
    "gap_fill_long": {
      "enabled": false,
      "_comment": "Quick Win: Disabled per Audit Task 4 - 12 signals, 0 executions (waste of compute)",
      "min_gap_pct": 0.3,
      "max_gap_pct": 2.5,
      "require_volume_confirmation": true,
      "target_mult_t1": 1.0,
      "target_mult_t2": 2.0,
      "confidence_level": 0.7
    },
    "gap_fill_short": {
      "enabled": false,
      "_comment": "Quick Win: Disabled per Audit Task 4 - 12 signals, 0 executions (waste of compute)",
      "min_gap_pct": 0.3,
      "max_gap_pct": 2.5,
      "require_volume_confirmation": true,
      "target_mult_t1": 1.0,
      "target_mult_t2": 2.0,
      "confidence_level": 0.7
    },
    "trend_pullback_long": {
      "enabled": true,
      "min_pullback_pct": 0.5,
      "_comment_min": "FIXED: 1.0 \u2192 0.5% - Capture shallow pullbacks in strong trends",
      "max_pullback_pct": 8.0,
      "_comment_max": "FIXED: 5.0 \u2192 8.0% - Professional Fibonacci 23.6%-38.2% retracements on 5-min can be 5-10%",
      "trend_confirmation_bars": 10,
      "min_trend_bars": 10,
      "pullback_depth_pct": 38.2,
      "min_trend_strength": 1.5,
      "min_momentum_score": 0.5,
      "require_volume_confirmation": false,
      "_comment_volume_old": "CHANGED: require_volume_confirmation false - old logic required HIGH volume which is WRONG for pullbacks",
      "require_volume_decline": true,
      "_comment_volume_decline": "PRO TRADER FIX: Healthy pullback = LOW volume (consolidation). Volume surge only on continuation breakout.",
      "max_volume_mult_during_pullback": 0.8,
      "_comment_max_vol": "Volume should be BELOW 0.8x average during pullback (consolidation phase). 5paisa research: low volume = healthy",
      "require_rsi_oversold": true,
      "_comment_rsi": "PRO TRADER: Standard is RSI<30 oversold (5paisa 80% WR). Using 35 as balance between quality (30) and quantity (40).",
      "rsi_oversold_threshold": 35,
      "_comment_rsi_threshold": "RSI < 35 for long pullbacks - between strict 30 and relaxed 40. Research: Chartink/5paisa use 30.",
      "require_rsi_overbought": false,
      "rsi_overbought_threshold": 65,
      "_comment_rsi_overbought": "Disabled for longs - overbought check not relevant for buying pullbacks",
      "min_volume_mult": 1.3,
      "min_stop_distance_pct": 0.5,
      "stop_distance_mult": 0.75,
      "target_mult_t1": 1.5,
      "target_mult_t2": 2.5,
      "confidence_strong_trend": 0.8,
      "confidence_weak_trend": 0.65,
      "swing_sl_buffer_atr": 0.3,
      "_comment_swing_sl": "ATR buffer beyond swing low/high for stop loss placement",
      "swing_lookback_bars": 10,
      "_comment_swing_lookback": "Number of bars to look back for swing points"
    },
    "trend_pullback_short": {
      "enabled": true,
      "min_pullback_pct": 0.5,
      "_comment_min": "FIXED: 1.0 \u2192 0.5% - Capture shallow pullbacks in strong trends",
      "max_pullback_pct": 8.0,
      "_comment_max": "FIXED: 5.0 \u2192 8.0% - Professional Fibonacci 23.6%-38.2% retracements on 5-min can be 5-10%",
      "trend_confirmation_bars": 10,
      "min_trend_bars": 10,
      "pullback_depth_pct": 38.2,
      "min_trend_strength": 1.5,
      "min_momentum_score": 0.5,
      "require_volume_confirmation": false,
      "_comment_volume_old": "CHANGED: require_volume_confirmation false - old logic required HIGH volume which is WRONG for pullbacks",
      "require_volume_decline": true,
      "_comment_volume_decline": "PRO TRADER FIX: Healthy pullback = LOW volume (consolidation). Volume surge only on continuation breakdown.",
      "max_volume_mult_during_pullback": 0.8,
      "_comment_max_vol": "Volume should be BELOW 0.8x average during pullback (consolidation phase)",
      "require_rsi_overbought": true,
      "_comment_rsi": "PRO TRADER: Standard is RSI>70 overbought. Using 65 as balance between quality (70) and quantity (60).",
      "rsi_overbought_threshold": 65,
      "_comment_rsi_threshold": "RSI > 65 for short pullbacks - between strict 70 and relaxed 60. Research: Chartink uses 70.",
      "require_rsi_oversold": false,
      "rsi_oversold_threshold": 35,
      "_comment_rsi_oversold": "Disabled for shorts - oversold check not relevant for selling bounces",
      "min_volume_mult": 1.3,
      "min_stop_distance_pct": 0.5,
      "stop_distance_mult": 0.75,
      "target_mult_t1": 1.5,
      "target_mult_t2": 2.5,
      "confidence_strong_trend": 0.8,
      "confidence_weak_trend": 0.65,
      "swing_sl_buffer_atr": 0.3,
      "_comment_swing_sl": "ATR buffer beyond swing low/high for stop loss placement",
      "swing_lookback_bars": 10,
      "_comment_swing_lookback": "Number of bars to look back for swing points"
    },
    "trend_continuation_long": {
      "enabled": true,
      "min_trend_strength": 1.2,
      "min_trend_bars": 8,
      "min_pullback_pct": 0.3,
      "_comment_min": "FIXED: 0.5 \u2192 0.3% - Capture micro-pullbacks in momentum continuation",
      "max_pullback_pct": 5.0,
      "_comment_max": "FIXED: 2.0 \u2192 5.0% - Professional continuation patterns allow 3-5% consolidation, hardcoded 15% removed from code",
      "require_volume_confirmation": true,
      "require_volume_decline": false,
      "_comment_vol_decline": "Continuation wants HIGH volume (momentum), not low volume like pullbacks",
      "max_volume_mult_during_pullback": 0.8,
      "require_rsi_oversold": false,
      "rsi_oversold_threshold": 35,
      "require_rsi_overbought": false,
      "rsi_overbought_threshold": 65,
      "_comment_rsi": "RSI checks disabled for continuation (wants momentum, not extremes). Thresholds kept consistent with pullback configs.",
      "min_volume_mult": 1.3,
      "min_momentum_score": 0.6,
      "min_stop_distance_pct": 0.5,
      "stop_distance_mult": 0.75,
      "target_mult_t1": 1.0,
      "target_mult_t2": 2.0,
      "confidence_strong_trend": 0.85,
      "confidence_weak_trend": 0.7,
      "swing_sl_buffer_atr": 0.3,
      "_comment_swing_sl": "ATR buffer beyond swing low for stop loss placement",
      "swing_lookback_bars": 8,
      "_comment_swing_lookback": "Number of bars to look back for swing points"
    },
    "trend_continuation_short": {
      "enabled": true,
      "min_trend_strength": 1.2,
      "min_trend_bars": 8,
      "min_pullback_pct": 0.3,
      "_comment_min": "FIXED: 0.5 \u2192 0.3% - Capture micro-pullbacks in momentum continuation",
      "max_pullback_pct": 5.0,
      "_comment_max": "FIXED: 2.0 \u2192 5.0% - Professional continuation patterns allow 3-5% consolidation, hardcoded 15% removed from code",
      "require_volume_confirmation": true,
      "require_volume_decline": false,
      "_comment_vol_decline": "Continuation wants HIGH volume (momentum), not low volume like pullbacks",
      "max_volume_mult_during_pullback": 0.8,
      "require_rsi_oversold": false,
      "rsi_oversold_threshold": 35,
      "require_rsi_overbought": false,
      "rsi_overbought_threshold": 65,
      "_comment_rsi": "RSI checks disabled for continuation (wants momentum, not extremes). Thresholds kept consistent with pullback configs.",
      "min_volume_mult": 1.3,
      "min_momentum_score": 0.6,
      "min_stop_distance_pct": 0.5,
      "stop_distance_mult": 0.75,
      "target_mult_t1": 1.0,
      "target_mult_t2": 2.0,
      "confidence_strong_trend": 0.85,
      "confidence_weak_trend": 0.7,
      "swing_sl_buffer_atr": 0.3,
      "_comment_swing_sl": "ATR buffer beyond swing high for stop loss placement",
      "swing_lookback_bars": 8,
      "_comment_swing_lookback": "Number of bars to look back for swing points"
    },
    "volume_spike_reversal_long": {
      "enabled": true,
      "min_volume_spike_mult": 1.2,
      "_comment_vol_z": "FIXED: 3.0 \u2192 1.2 - Professional NSE standard: 1.2-1.5x volume surge = institutional participation. 3.0\u03c3 vol_z was 99.7th percentile (only major news/capitulation events). Aligns with ORB/support strategies using 1.5x volume mult",
      "min_body_size_pct": 0.8,
      "_comment_body": "FIXED: 1.0 \u2192 0.8% - Realistic 5-min reversal candles. NSE 5-min range typically 0.3-1.5%, 0.8% captures meaningful reversals without being extreme",
      "reversal_threshold_pct": 2.0,
      "target_mult_t1": 1.0,
      "target_mult_t2": 2.0,
      "confidence_level": 0.7,
      "spike_sl_buffer_atr": 0.3,
      "_comment_spike_sl": "ATR buffer beyond spike candle low for stop loss placement",
      "min_stop_distance_pct": 0.3,
      "_comment_min_stop": "Minimum stop loss distance as percentage of price"
    },
    "volume_spike_reversal_short": {
      "enabled": true,
      "min_volume_spike_mult": 1.5,
      "_comment_vol_z": "FIXED: 3.0 \u2192 1.5 - Stricter than longs (1.5 vs 1.2), aligns with system's short-bias caution (breakout_volume_surge_min_short: 2.0). Still captures strong distribution volume",
      "min_body_size_pct": 0.8,
      "_comment_body": "FIXED: 1.0 \u2192 0.8% - Same as longs, realistic 5-min reversal candles",
      "reversal_threshold_pct": 2.0,
      "target_mult_t1": 1.0,
      "target_mult_t2": 2.0,
      "confidence_level": 0.7,
      "spike_sl_buffer_atr": 0.3,
      "_comment_spike_sl": "ATR buffer beyond spike candle high for stop loss placement",
      "min_stop_distance_pct": 0.3,
      "_comment_min_stop": "Minimum stop loss distance as percentage of price"
    },
    "volume_breakout_long": {
      "enabled": false,
      "min_volume_spike_mult": 2.5,
      "min_breakout_pct": 0.5,
      "target_mult_t1": 1.5,
      "target_mult_t2": 2.5,
      "confidence_level": 0.75
    },
    "volume_breakout_short": {
      "enabled": false,
      "min_volume_spike_mult": 2.5,
      "min_breakout_pct": 0.5,
      "target_mult_t1": 1.5,
      "target_mult_t2": 2.5,
      "confidence_level": 0.75
    },
    "gap_breakout_long": {
      "enabled": false,
      "min_gap_pct": 0.3,
      "max_gap_pct": 2.5,
      "require_volume_confirmation": true,
      "target_mult_t1": 1.0,
      "target_mult_t2": 1.5,
      "confidence_level": 0.75
    },
    "gap_breakout_short": {
      "enabled": false,
      "min_gap_pct": 0.3,
      "max_gap_pct": 2.5,
      "require_volume_confirmation": true,
      "target_mult_t1": 1.0,
      "target_mult_t2": 1.5,
      "confidence_level": 0.75
    },
    "range_bounce_long": {
      "enabled": true,
      "min_range_duration": 6,
      "max_range_height_pct": 3.0,
      "min_range_height_pct": 0.5,
      "bounce_tolerance_pct": 0.2,
      "breakout_confirmation_pct": 0.3,
      "require_volume_confirmation": false,
      "min_volume_mult": 1.5,
      "target_mult_t1": 1.0,
      "target_mult_t2": 2.0,
      "confidence_level": 0.7,
      "bounce_sl_buffer_atr": 0.3,
      "_comment_bounce_sl": "ATR buffer beyond range support for bounce SL",
      "breakout_sl_buffer_atr": 0.5,
      "_comment_breakout_sl": "ATR buffer inside range for breakout SL",
      "min_stop_distance_pct": 0.3,
      "_comment_min_stop": "Minimum stop loss distance as percentage of price"
    },
    "range_bounce_short": {
      "enabled": true,
      "min_range_duration": 6,
      "max_range_height_pct": 3.0,
      "min_range_height_pct": 0.5,
      "bounce_tolerance_pct": 0.2,
      "breakout_confirmation_pct": 0.3,
      "require_volume_confirmation": false,
      "min_volume_mult": 1.5,
      "target_mult_t1": 1.0,
      "target_mult_t2": 2.0,
      "confidence_level": 0.7,
      "bounce_sl_buffer_atr": 0.3,
      "_comment_bounce_sl": "ATR buffer beyond range resistance for bounce SL",
      "breakout_sl_buffer_atr": 0.5,
      "_comment_breakout_sl": "ATR buffer inside range for breakout SL",
      "min_stop_distance_pct": 0.3,
      "_comment_min_stop": "Minimum stop loss distance as percentage of price",
      "blocked_cap_segments": [
        "large_cap"
      ],
      "_comment_blocked_cap": "DATA-DRIVEN: 6-month backtest shows large_cap range_bounce_short: 92 trades, 9.8% WR, Rs -10,197 PnL, 52.2% hard_sl. Blocking adds Rs +10,197 to PnL."
    },
    "range_breakout_long": {
      "enabled": false,
      "min_range_duration": 20,
      "max_range_height_pct": 3.0,
      "min_range_height_pct": 0.5,
      "breakout_confirmation_pct": 0.3,
      "require_volume_confirmation": true,
      "min_volume_mult": 1.5,
      "target_mult_t1": 1.0,
      "target_mult_t2": 2.0,
      "confidence_level": 0.7
    },
    "range_breakdown_short": {
      "enabled": false,
      "min_range_duration": 20,
      "max_range_height_pct": 3.0,
      "min_range_height_pct": 0.5,
      "breakout_confirmation_pct": 0.3,
      "require_volume_confirmation": true,
      "min_volume_mult": 1.5,
      "target_mult_t1": 1.0,
      "target_mult_t2": 2.0,
      "confidence_level": 0.7
    },
    "level_breakout_long": {
      "enabled": true,
      "k_atr": 0.15,
      "_comment_k_atr": "FIXED: 0.25 \u2192 0.15 - Professional NSE standard for early breakout entry. 0.25 ATR was missing 60-70% of valid breakouts",
      "min_breakout_atr_mult": 0.2,
      "_comment_min_breakout": "FIXED: 0.3 \u2192 0.20 - Allow smaller but valid breakouts. NSE 5-min breakouts often 0.2-0.25 ATR (was rejecting professional-size moves)",
      "hold_bars": 1,
      "vol_z_required": 1.0,
      "_comment_vol_z": "FIXED: 1.5 \u2192 1.0 - Institutional participation threshold (68th %ile vs 84th). 1.5\u03c3 was only capturing extreme volume events",
      "require_breakout_bar_volume_surge": true,
      "breakout_volume_min_ratio": 1.3,
      "_comment_volume_ratio": "FIXED: 1.4 \u2192 1.3 - NSE professional standard per research (ORB strategies use 1.3x). 1.4x was too strict, missing valid institutional breakouts",
      "enable_smc_filtering": true,
      "liquidity_grab_tolerance_pct": 0.3,
      "_comment_liquidity": "FIXED: 0.2 \u2192 0.3% - Normal NSE 5-min volatility. 0.2% was rejecting normal wick patterns (0.3-0.5% wicks are standard)",
      "sl_atr_multiplier": 2.0,
      "_sl_rationale": "PHASE 1 UPDATE: Set to 2.0x ATR based on 6-month MFE/MAE analysis (1.41x ratio proves stops too tight)",
      "min_stop_distance_pct": 0.3,
      "_comment_min_stop": "Minimum stop loss distance as percentage of price",
      "target_mult_t1": 2.0,
      "target_mult_t2": 3.0,
      "confidence_strong_breakout": 0.85,
      "confidence_weak_breakout": 0.65,
      "_comment_dual_mode": "DUAL-MODE ENTRY FIX (2025-11-23): Fixes 99% expiry rate by implementing immediate + retest entry modes",
      "entry_mode": "immediate",
      "_comment_entry_mode": "Entry mode: 'immediate' (aggressive, high-conviction), 'retest' (wait for pullback), or 'pending' (legacy tight zone)",
      "aggressive_min_volume_z": 1.8,
      "_comment_aggressive_volume": "Minimum volume z-score for immediate entry (high-conviction breakouts only)",
      "aggressive_min_conviction": 0.7,
      "_comment_aggressive_conviction": "Minimum confidence score for immediate entry (institutional-grade breakouts)",
      "retest_entry_zone_width_atr": 0.5,
      "_comment_retest_zone": "Entry zone width around level for retest mode (0.5 ATR \u2248 0.5% for NSE stocks)",
      "retest_timeout_minutes": 30,
      "_comment_retest_timeout": "How long to wait for retest entry before expiring (30 minutes default)",
      "allow_both_modes": true,
      "_comment_allow_both": "If true, aggressive mode failures fall back to retest mode (recommended for maximizing trade count)"
    },
    "level_breakout_short": {
      "enabled": false,
      "_comment": "PHASE 1 FIX: Disabled to prevent short breakouts. This is the ACTUAL detector control (breakout_short section only controls gate filtering).",
      "k_atr": 0.25,
      "sl_atr_multiplier": 2.0,
      "min_breakout_atr_mult": 0.3,
      "hold_bars": 1,
      "vol_z_required": 1.5,
      "require_breakout_bar_volume_surge": true,
      "breakout_volume_min_ratio": 1.4,
      "enable_smc_filtering": true,
      "liquidity_grab_tolerance_pct": 0.2,
      "target_mult_t1": 2.0,
      "target_mult_t2": 3.0,
      "confidence_strong_breakout": 0.85,
      "confidence_weak_breakout": 0.65
    },
    "orb_level_breakout_long": {
      "enabled": true,
      "_comment": "ORB-related level breakouts (at ORH/ORL) - uses same params as level_breakout_long",
      "k_atr": 0.15,
      "min_breakout_atr_mult": 0.2,
      "hold_bars": 1,
      "vol_z_required": 1.0,
      "require_breakout_bar_volume_surge": true,
      "breakout_volume_min_ratio": 1.3,
      "enable_smc_filtering": true,
      "liquidity_grab_tolerance_pct": 0.3,
      "sl_atr_multiplier": 2.0,
      "min_stop_distance_pct": 0.3,
      "target_mult_t1": 2.0,
      "target_mult_t2": 3.0,
      "confidence_strong_breakout": 0.85,
      "confidence_weak_breakout": 0.65,
      "entry_mode": "immediate",
      "aggressive_min_volume_z": 1.8,
      "aggressive_min_conviction": 0.7,
      "retest_entry_zone_width_atr": 0.5,
      "retest_timeout_minutes": 30,
      "allow_both_modes": true
    },
    "orb_level_breakout_short": {
      "enabled": false,
      "_comment": "ORB-related level breakouts (at ORH/ORL) - uses same params as level_breakout_short",
      "k_atr": 0.25,
      "sl_atr_multiplier": 2.0,
      "min_breakout_atr_mult": 0.3,
      "hold_bars": 1,
      "vol_z_required": 1.5,
      "require_breakout_bar_volume_surge": true,
      "breakout_volume_min_ratio": 1.4,
      "enable_smc_filtering": true,
      "liquidity_grab_tolerance_pct": 0.2,
      "target_mult_t1": 2.0,
      "target_mult_t2": 3.0,
      "confidence_strong_breakout": 0.85,
      "confidence_weak_breakout": 0.65,
      "entry_mode": "immediate",
      "aggressive_min_volume_z": 1.8,
      "aggressive_min_conviction": 0.7,
      "retest_entry_zone_width_atr": 0.5,
      "retest_timeout_minutes": 30,
      "allow_both_modes": true
    },
    "failure_fade_long": {
      "enabled": true,
      "min_pierce_size_pct": 0.1,
      "max_pierce_size_pct": 1.0,
      "fade_confirmation_bars": 1,
      "require_volume_confirmation": false,
      "min_volume_mult": 1.2,
      "min_fade_strength": 0.6,
      "_comment_fade_strength": "INSTITUTIONAL FIX: Increased from 0.3 to 0.6 to filter weak bounces (14/19 SL hits in chop regime at 0.3)",
      "_comment_adx_filter": "INSTITUTIONAL FIX (exit-opt-004): ADX >= 15 required in regime_gate.py to avoid weak/choppy trades. Analysis: saves Rs.2,718 (18 hard_sl avoided vs 15 winners lost). Checked at DECISION time on 5m bar.",
      "target_mult_t1": 1.0,
      "target_mult_t2": 2.0,
      "stop_mult": 1.5,
      "confidence_strong_fade": 0.8,
      "confidence_weak_fade": 0.6
    },
    "failure_fade_short": {
      "enabled": true,
      "min_pierce_size_pct": 0.1,
      "max_pierce_size_pct": 1.0,
      "fade_confirmation_bars": 1,
      "require_volume_confirmation": false,
      "min_volume_mult": 1.2,
      "min_fade_strength": 0.6,
      "_comment_fade_strength": "INSTITUTIONAL FIX: Increased from 0.3 to 0.6 for consistency with failure_fade_long",
      "_comment_adx_filter": "INSTITUTIONAL FIX (exit-opt-004): ADX >= 15 required in regime_gate.py to avoid weak/choppy trades. Analysis: saves Rs.2,718 (18 hard_sl avoided vs 15 winners lost). Checked at DECISION time on 5m bar.",
      "target_mult_t1": 1.0,
      "target_mult_t2": 2.0,
      "stop_mult": 1.5,
      "confidence_strong_fade": 0.8,
      "confidence_weak_fade": 0.6
    },
    "squeeze_release_long": {
      "enabled": true,
      "width_window": 12,
      "_comment_width_window": "AGGRESSIVE FIX: 40 \u2192 12 bars (60min). Professional traders use hourly reference for 5min squeeze detection. Can revert to 24 (120min) if too many bad trades.",
      "expansion_ratio": 1.25,
      "_comment_expansion": "PRO TRADER FIX: 1.5 \u2192 1.25 - Chartink/Kite screeners use 1.2-1.3x expansion. 1.5x too strict.",
      "enable_nr7_pattern": true,
      "nr7_lookback": 7,
      "_comment_nr7": "NR7 Pattern: Range smallest of last 7 periods - volatility contraction signal per Chartink screeners",
      "width_calculation_period": 20,
      "recent_width_bars": 5,
      "momentum_period": 3,
      "min_momentum_threshold": 0.001,
      "require_volume_confirmation": false,
      "_comment_volume": "Disabled volume confirmation to isolate width_window effect",
      "min_volume_mult": 1.5,
      "target_mult_t1": 1.5,
      "target_mult_t2": 2.5,
      "stop_mult": 1.5,
      "confidence_strong_expansion": 0.8,
      "confidence_weak_expansion": 0.6
    },
    "squeeze_release_short": {
      "enabled": true,
      "width_window": 12,
      "_comment_width_window": "AGGRESSIVE FIX: 40 \u2192 12 bars (60min). Professional traders use hourly reference for 5min squeeze detection. Can revert to 24 (120min) if too many bad trades.",
      "expansion_ratio": 1.25,
      "_comment_expansion": "PRO TRADER FIX: 1.5 \u2192 1.25 - Chartink/Kite screeners use 1.2-1.3x expansion. 1.5x too strict.",
      "enable_nr7_pattern": true,
      "nr7_lookback": 7,
      "_comment_nr7": "NR7 Pattern: Range smallest of last 7 periods - volatility contraction signal per Chartink screeners",
      "width_calculation_period": 20,
      "recent_width_bars": 5,
      "momentum_period": 3,
      "min_momentum_threshold": 0.001,
      "require_volume_confirmation": false,
      "_comment_volume": "Disabled volume confirmation to isolate width_window effect",
      "min_volume_mult": 1.5,
      "target_mult_t1": 1.5,
      "target_mult_t2": 2.5,
      "stop_mult": 1.5,
      "confidence_strong_expansion": 0.8,
      "confidence_weak_expansion": 0.6
    },
    "flag_continuation_long": {
      "enabled": true,
      "min_consolidation_bars": 3,
      "max_consolidation_bars": 12,
      "min_trend_strength": 1.5,
      "trend_lookback_period": 10,
      "max_consolidation_range_pct": 2.0,
      "breakout_confirmation_pct": 0.1,
      "require_volume_confirmation": true,
      "min_volume_mult": 1.5,
      "target_mult_t1": 1.5,
      "target_mult_t2": 2.5,
      "stop_mult": 1.0,
      "confidence_strong_flag": 0.85,
      "confidence_weak_flag": 0.65
    },
    "flag_continuation_short": {
      "enabled": true,
      "min_consolidation_bars": 3,
      "max_consolidation_bars": 12,
      "min_trend_strength": 1.5,
      "trend_lookback_period": 10,
      "max_consolidation_range_pct": 2.0,
      "breakout_confirmation_pct": 0.1,
      "require_volume_confirmation": true,
      "min_volume_mult": 1.5,
      "target_mult_t1": 1.5,
      "target_mult_t2": 2.5,
      "stop_mult": 1.0,
      "confidence_strong_flag": 0.85,
      "confidence_weak_flag": 0.65
    },
    "momentum_breakout_long": {
      "enabled": true,
      "min_momentum_3bar_pct": 0.8,
      "_comment_3bar": "FIXED: 1.5 \u2192 0.8% - Professional NSE intraday momentum range is 0.5-1.5%, was rejecting most valid setups at upper end only",
      "min_momentum_1bar_pct": 0.3,
      "_comment_1bar": "FIXED: 0.5 \u2192 0.3% - Slightly more lenient for 5-min bar momentum, aligns with scalping targets of 0.5-1%",
      "min_momentum_2bar_pct": 0.6,
      "_comment_2bar": "FIXED: 1.0 \u2192 0.6% - Proportional reduction to match 3-bar adjustment",
      "min_trend_5bar_pct": 2.0,
      "min_trend_3bar_pct": 1.0,
      "min_positive_bars": 2,
      "vol_z_breakout_mult": 0.8,
      "vol_z_continuation_mult": 0.6,
      "min_volume_surge_ratio": 1.2,
      "_comment_volume": "FIXED: 1.3 \u2192 1.2 - Slightly more lenient while still requiring institutional participation",
      "target_mult_t1": 1.5,
      "target_mult_t2": 2.5,
      "stop_mult": 1.5,
      "confidence_strong_momentum": 0.8,
      "confidence_weak_momentum": 0.6,
      "swing_sl_buffer_atr": 0.3,
      "_comment_swing_sl": "ATR buffer beyond swing low for stop loss placement",
      "min_stop_distance_pct": 0.3,
      "_comment_min_stop": "Minimum stop loss distance as percentage of price",
      "swing_lookback_bars": 8,
      "_comment_swing_lookback": "Number of bars to look back for swing points"
    },
    "momentum_breakout_short": {
      "enabled": true,
      "min_momentum_3bar_pct": 0.8,
      "_comment_3bar": "FIXED: 1.5 \u2192 0.8% - Professional NSE intraday momentum range is 0.5-1.5%, was rejecting most valid setups at upper end only",
      "min_momentum_1bar_pct": 0.3,
      "_comment_1bar": "FIXED: 0.5 \u2192 0.3% - Slightly more lenient for 5-min bar momentum, aligns with scalping targets of 0.5-1%",
      "min_momentum_2bar_pct": 0.6,
      "_comment_2bar": "FIXED: 1.0 \u2192 0.6% - Proportional reduction to match 3-bar adjustment",
      "min_trend_5bar_pct": 2.0,
      "min_trend_3bar_pct": 1.0,
      "min_positive_bars": 2,
      "vol_z_breakout_mult": 0.8,
      "vol_z_continuation_mult": 0.6,
      "min_volume_surge_ratio": 1.2,
      "_comment_volume": "FIXED: 1.3 \u2192 1.2 - Slightly more lenient while still requiring institutional participation",
      "target_mult_t1": 1.5,
      "target_mult_t2": 2.5,
      "stop_mult": 1.5,
      "confidence_strong_momentum": 0.8,
      "confidence_weak_momentum": 0.6,
      "swing_sl_buffer_atr": 0.3,
      "_comment_swing_sl": "ATR buffer beyond swing high for stop loss placement",
      "min_stop_distance_pct": 0.3,
      "_comment_min_stop": "Minimum stop loss distance as percentage of price",
      "swing_lookback_bars": 8,
      "_comment_swing_lookback": "Number of bars to look back for swing points"
    },
    "support_bounce_long": {
      "enabled": true,
      "target_structure_type": "support_bounce_long",
      "min_touches": 2,
      "bounce_tolerance_pct": 0.8,
      "_comment_tolerance": "FIXED: 0.3 \u2192 0.8% - Professional standard for S/R zones (0.7-1.0%). Aligns with 'support as zone' industry practice.",
      "require_volume_spike": true,
      "min_volume_mult": 1.5,
      "min_level_age_bars": 5,
      "max_level_distance_pct": 2.0,
      "level_merge_tolerance_pct": 0.3,
      "breakout_buffer_pct": 0.2,
      "min_breakout_volume_mult": 1.8,
      "min_stop_distance_pct": 0.5,
      "stop_distance_mult": 0.5,
      "level_buffer_mult": 0.1,
      "target_mult_t1": 1.5,
      "target_mult_t2": 2.5,
      "confidence_strong_level": 0.85,
      "confidence_weak_level": 0.65,
      "confidence_breakout": 0.8,
      "confidence_bounce": 0.75,
      "_comment_dual_mode": "=== DUAL-MODE ENTRY (Professional S/R Trading) ===",
      "entry_mode": "conditional",
      "_comment_entry_mode": "Entry mode: 'immediate', 'retest', or 'conditional'. Conditional = immediate if within immediate_entry_distance_pct, else retest.",
      "immediate_entry_distance_pct": 0.6,
      "_comment_immediate_dist": "OPTIMIZED: 0.3 \u2192 0.6% - Same as resistance_bounce_short. Higher trigger rate while maintaining R:R.",
      "retest_entry_zone_width_atr": 0.5,
      "_comment_retest_zone": "OPTIMIZED: 0.3 \u2192 0.5 ATR - Wider zone to increase trigger rate.",
      "retest_timeout_minutes": 60,
      "_comment_retest_timeout": "OPTIMIZED: 45 \u2192 60 min - More time for retest entries."
    },
    "resistance_bounce_short": {
      "enabled": true,
      "target_structure_type": "resistance_bounce_short",
      "min_touches": 2,
      "bounce_tolerance_pct": 0.8,
      "_comment_tolerance": "FIXED: 0.3 \u2192 0.8% - Professional standard for S/R zones (0.7-1.0%). Aligns with 'support as zone' industry practice.",
      "require_volume_spike": true,
      "min_volume_mult": 1.5,
      "min_level_age_bars": 5,
      "max_level_distance_pct": 2.0,
      "level_merge_tolerance_pct": 0.3,
      "breakout_buffer_pct": 0.2,
      "min_breakout_volume_mult": 1.8,
      "min_stop_distance_pct": 0.5,
      "stop_distance_mult": 0.8,
      "_comment_stop": "FIXED: 0.5 \u2192 0.8 ATR - Spike test (1m bar timing analysis) showed 40% of trades hit SL before T1. Stops too tight for normal price noise. Widening to give breathing room.",
      "level_buffer_mult": 0.1,
      "target_mult_t1": 1.5,
      "_comment_t1": "REVERTED: 2.0 \u2192 1.5 - Spike test showed issue is tight stops, not tight targets. Keeping original T1.",
      "target_mult_t2": 2.5,
      "_comment_t2": "REVERTED: 3.5 \u2192 2.5 - Keeping original T2 after confirming stops are the issue.",
      "confidence_strong_level": 0.85,
      "confidence_weak_level": 0.65,
      "confidence_breakout": 0.8,
      "confidence_bounce": 0.75,
      "_comment_dual_mode": "=== DUAL-MODE ENTRY (Professional S/R Trading) ===",
      "entry_mode": "conditional",
      "_comment_entry_mode": "Entry mode: 'immediate', 'retest', or 'conditional'. Conditional = immediate if within immediate_entry_distance_pct, else retest.",
      "immediate_entry_distance_pct": 0.6,
      "_comment_immediate_dist": "OPTIMIZED: 0.3 \u2192 0.6% - Backtest showed 8.3% trigger rate too low. Widening allows more immediate entries while maintaining good R:R.",
      "retest_entry_zone_width_atr": 0.5,
      "_comment_retest_zone": "OPTIMIZED: 0.3 \u2192 0.5 ATR - Wider zone to increase trigger rate from 8.3% to ~15-20%.",
      "retest_timeout_minutes": 60,
      "_comment_retest_timeout": "OPTIMIZED: 45 \u2192 60 min - More time for retest entries. Regime won't change significantly in extra 15 min."
    },
    "support_breakdown_short": {
      "enabled": true,
      "target_structure_type": "support_breakdown_short",
      "min_touches": 2,
      "bounce_tolerance_pct": 0.3,
      "require_volume_spike": true,
      "min_volume_mult": 1.5,
      "min_level_age_bars": 5,
      "max_level_distance_pct": 2.0,
      "level_merge_tolerance_pct": 0.3,
      "breakout_buffer_pct": 0.25,
      "min_breakout_volume_mult": 2.0,
      "min_stop_distance_pct": 0.5,
      "stop_distance_mult": 0.5,
      "level_buffer_mult": 0.15,
      "target_mult_t1": 2.0,
      "target_mult_t2": 3.0,
      "confidence_strong_level": 0.85,
      "confidence_weak_level": 0.65,
      "confidence_breakout": 0.85,
      "confidence_bounce": 0.75,
      "_comment_dual_mode": "=== DUAL-MODE ENTRY (Professional Breakout Trading) ===",
      "entry_mode": "conditional",
      "_comment_entry_mode": "Conditional: immediate if within immediate_entry_distance_pct of broken level, else retest (wait for pullback to level)",
      "immediate_entry_distance_pct": 0.5,
      "_comment_immediate_dist": "Breakouts: wider 0.5% zone since momentum is key. If price just broke, enter immediately.",
      "retest_entry_zone_width_atr": 0.3,
      "retest_timeout_minutes": 45
    },
    "resistance_breakout_long": {
      "enabled": true,
      "target_structure_type": "resistance_breakout_long",
      "min_touches": 2,
      "bounce_tolerance_pct": 0.3,
      "require_volume_spike": true,
      "min_volume_mult": 1.5,
      "min_level_age_bars": 5,
      "max_level_distance_pct": 2.0,
      "level_merge_tolerance_pct": 0.3,
      "breakout_buffer_pct": 0.25,
      "min_breakout_volume_mult": 2.0,
      "min_stop_distance_pct": 0.5,
      "stop_distance_mult": 0.5,
      "level_buffer_mult": 0.15,
      "target_mult_t1": 2.0,
      "target_mult_t2": 3.0,
      "confidence_strong_level": 0.85,
      "confidence_weak_level": 0.65,
      "confidence_breakout": 0.85,
      "confidence_bounce": 0.75,
      "_comment_dual_mode": "=== DUAL-MODE ENTRY (Professional Breakout Trading) ===",
      "entry_mode": "conditional",
      "_comment_entry_mode": "Conditional: immediate if within immediate_entry_distance_pct of broken level, else retest (wait for pullback to level)",
      "immediate_entry_distance_pct": 0.5,
      "_comment_immediate_dist": "Breakouts: wider 0.5% zone since momentum is key. If price just broke, enter immediately.",
      "retest_entry_zone_width_atr": 0.3,
      "retest_timeout_minutes": 45
    },
    "orb_breakout_long": {
      "enabled": true,
      "orb_minutes": 15,
      "min_bars_required": 4,
      "_comment_min_bars": "Pro traders use 15-min range (3 bars) + 1 bar for breakout = 4 bars minimum. Allows detection from 9:35",
      "min_range_pct": 0.5,
      "breakout_volume_mult": 1.5,
      "breakout_buffer_pct": 0.5,
      "min_stop_distance_pct": 0.5,
      "stop_distance_mult": 1.5,
      "target_mult_t1": 1.0,
      "target_mult_t2": 1.5,
      "confidence_volume_confirmed": 0.8,
      "confidence_no_volume": 0.6,
      "or_level_buffer_mult": 0.1,
      "pullback_zones": {
        "shallow": 0.25,
        "medium": 0.5,
        "deep": 0.618
      },
      "require_candle_close": true,
      "require_nr7_day": false,
      "nr7_lookback_days": 7,
      "require_vwap_alignment": true
    },
    "orb_breakout_short": {
      "enabled": true,
      "orb_minutes": 15,
      "min_bars_required": 4,
      "min_range_pct": 0.5,
      "breakout_volume_mult": 1.5,
      "breakout_buffer_pct": 0.5,
      "min_stop_distance_pct": 0.5,
      "stop_distance_mult": 1.5,
      "target_mult_t1": 1.0,
      "target_mult_t2": 1.5,
      "confidence_volume_confirmed": 0.8,
      "confidence_no_volume": 0.6,
      "or_level_buffer_mult": 0.1,
      "pullback_zones": {
        "shallow": 0.25,
        "medium": 0.5,
        "deep": 0.618
      },
      "require_candle_close": true,
      "require_nr7_day": false,
      "nr7_lookback_days": 7,
      "require_vwap_alignment": true
    },
    "orb_breakdown_short": {
      "enabled": true,
      "orb_minutes": 15,
      "min_bars_required": 4,
      "min_range_pct": 0.5,
      "breakout_volume_mult": 1.5,
      "breakout_buffer_pct": 0.5,
      "min_stop_distance_pct": 0.5,
      "stop_distance_mult": 1.5,
      "target_mult_t1": 1.0,
      "target_mult_t2": 1.5,
      "confidence_volume_confirmed": 0.8,
      "confidence_no_volume": 0.6,
      "or_level_buffer_mult": 0.1,
      "pullback_zones": {
        "shallow": 0.25,
        "medium": 0.5,
        "deep": 0.618
      },
      "require_candle_close": true,
      "require_nr7_day": false,
      "nr7_lookback_days": 7,
      "require_vwap_alignment": true
    },
    "orb_breakout": {
      "enabled": true,
      "orb_minutes": 15,
      "min_bars_required": 4,
      "min_range_pct": 0.5,
      "breakout_volume_mult": 1.5,
      "breakout_buffer_pct": 0.5,
      "min_stop_distance_pct": 0.5,
      "stop_distance_mult": 1.5,
      "target_mult_t1": 1.0,
      "target_mult_t2": 1.5,
      "confidence_volume_confirmed": 0.8,
      "confidence_no_volume": 0.6,
      "or_level_buffer_mult": 0.1,
      "pullback_zones": {
        "shallow": 0.25,
        "medium": 0.5,
        "deep": 0.618
      },
      "require_candle_close": true,
      "require_nr7_day": false,
      "nr7_lookback_days": 7,
      "require_vwap_alignment": true
    },
    "orb_breakdown": {
      "enabled": true,
      "orb_minutes": 15,
      "min_bars_required": 4,
      "min_range_pct": 0.5,
      "breakout_volume_mult": 1.5,
      "breakout_buffer_pct": 0.5,
      "min_stop_distance_pct": 0.5,
      "stop_distance_mult": 1.5,
      "target_mult_t1": 1.0,
      "target_mult_t2": 1.5,
      "confidence_volume_confirmed": 0.8,
      "confidence_no_volume": 0.6,
      "or_level_buffer_mult": 0.1,
      "pullback_zones": {
        "shallow": 0.25,
        "medium": 0.5,
        "deep": 0.618
      },
      "require_candle_close": true,
      "require_nr7_day": false,
      "nr7_lookback_days": 7,
      "require_vwap_alignment": true
    },
    "orb_pullback_long": {
      "enabled": true,
      "orb_minutes": 15,
      "min_bars_required": 4,
      "min_range_pct": 0.5,
      "breakout_volume_mult": 1.5,
      "breakout_buffer_pct": 0.5,
      "min_stop_distance_pct": 0.5,
      "stop_distance_mult": 1.0,
      "target_mult_t1": 2.0,
      "target_mult_t2": 2.5,
      "_optimized": "3YR 1m simulation (98 filtered trades): SL 1.00x, T1 2.00R -> NET Rs 29,929 (56.1% WR). +Rs 19K improvement.",
      "confidence_volume_confirmed": 0.8,
      "confidence_no_volume": 0.6,
      "or_level_buffer_mult": 0.1,
      "pullback_zones": {
        "shallow": 0.25,
        "medium": 0.5,
        "deep": 0.618
      },
      "require_candle_close": true,
      "require_nr7_day": false,
      "nr7_lookback_days": 7,
      "require_vwap_alignment": true
    },
    "orb_pullback_short": {
      "enabled": true,
      "orb_minutes": 15,
      "min_bars_required": 4,
      "min_range_pct": 0.5,
      "breakout_volume_mult": 1.5,
      "breakout_buffer_pct": 0.5,
      "min_stop_distance_pct": 0.5,
      "stop_distance_mult": 1.5,
      "target_mult_t1": 1.75,
      "target_mult_t2": 2.25,
      "_optimized": "3YR 1m simulation (694 filtered trades): SL 1.50x, T1 1.75R -> NET Rs 281,102 (65.3% WR). +Rs 215K improvement.",
      "confidence_volume_confirmed": 0.8,
      "confidence_no_volume": 0.6,
      "or_level_buffer_mult": 0.1,
      "pullback_zones": {
        "shallow": 0.25,
        "medium": 0.5,
        "deep": 0.618
      },
      "require_candle_close": true,
      "require_nr7_day": false,
      "nr7_lookback_days": 7,
      "require_vwap_alignment": true
    },
    "first_hour_momentum_long": {
      "_comment": "OPTIMIZED: squeeze + adx>=35 + vol>=100k = 20 trades, +2,073 Rs, +104 Rs/trade, 60% WR",
      "_research": "6-month backtest: 396 trades, -26,921 Rs baseline. Best 100+ Rs/trade filter found.",
      "_fix_details": "REGIME=SQUEEZE + ADX>=35 + Vol>=100k = highest avg profit per trade",
      "enabled": true,
      "detect_direction": "long",
      "min_bars_required": 5,
      "require_vwap_hold": false,
      "time_window": {
        "start": "09:20",
        "end": "10:30",
        "_comment": "First hour momentum window - full window, filtered by multi-bar confirmation"
      },
      "regime_filter": {
        "allowed_regimes": [
          "trend_up"
        ],
        "_comment": "UPDATED (Dec 2024): FHM Long ONLY in trend_up. Squeeze was -646 Rs (38% WR), trend_up +545 Rs (58% WR)"
      },
      "triggers": {
        "min_rvol": 2.0,
        "min_price_move_pct": 1.0,
        "min_volume": 100000,
        "_rvol_comment": "PRO STANDARD: RVOL>=2.0x indicates institutional activity",
        "_volume_comment": "OPTIMIZED: bar5_volume >= 100k for sufficient liquidity",
        "_adx_note": "ADX filter handled by breakout_pipeline gates.adx.fhm_long_min_adx=35"
      },
      "cap_rvol_thresholds": {
        "_comment": "OPTIMIZED: Cap-specific RVOL thresholds - raised for micro/small after backtest analysis",
        "micro_cap": 4.0,
        "small_cap": 3.5,
        "mid_cap": 2.0,
        "large_cap": 1.5,
        "_rationale": "INCREASED: micro 3.5\u21924.0, small 3.0\u21923.5 - backtest showed small/micro caps still losing despite 3.x RVOL"
      },
      "multi_bar_confirmation": {
        "enabled": true,
        "min_bullish_bars": 2,
        "lookback_bars": 3,
        "_comment": "RESEARCH: '2 of 3 consecutive 5-min bars bullish' to avoid false spikes"
      },
      "volume_continuation": {
        "enabled": true,
        "min_rvol_continuation": 1.2,
        "lookback_bars": 2,
        "_comment": "RESEARCH: RVOL remain >1.2x in subsequent bars to confirm follow-through"
      },
      "vwap_position": {
        "long_requires_above_vwap": false,
        "short_requires_below_vwap": false,
        "_comment": "VWAP alignment - using multi-bar and volume continuation instead of distance filter"
      },
      "entry": {
        "_comment": "Wait for pullback to VWAP AND hold for 1 candle",
        "mode": "pullback",
        "reference": "vwap",
        "zone_atr_mult": 0.1,
        "_zone_comment": "TIGHTENED: 0.15\u21920.10 ATR - Backtest showed high slippage (100-400bps); tighter zone = better entries"
      },
      "stop_loss": {
        "_comment": "DATA-DRIVEN (Dec 2024): 1m simulation showed 1.2% SL + 1.5R T1 = +348% improvement",
        "reference": "structure",
        "pct_of_price": 0.012,
        "buffer_atr_mult": 0.2,
        "_pct_comment": "WIDENED: 0.8% -> 1.2% - Avg MAE was 0.53%, tight SL hit on recoverable moves",
        "_evidence": "55 trades: Current Rs 1,886 -> Proposed Rs 8,451. 4 trades rescued (SL->T1), 16 T1 trades make more profit"
      },
      "targets": {
        "_comment": "DATA-DRIVEN (Dec 2024): 1.5R T1 captures more profit from momentum moves",
        "t1_rr": 1.5,
        "t2_rr": 2.5,
        "t3_rr": 3.5,
        "qty_split": [
          70,
          30,
          0
        ],
        "_t1_comment": "RAISED: 1.0R -> 1.5R - t1->t1 trades gained +Rs 9,972 with higher target"
      },
      "confidence_high_rvol": 2.0,
      "confidence_base": 1.5,
      "high_rvol_threshold": 3.0
    },
    "first_hour_momentum_short": {
      "_comment": "DISABLED: FHM Short thesis doesn't work in Indian markets",
      "_research": "Deep analysis Dec 2024: -4,269 Rs loss, rejected trades simulated = -7,654 Rs more. Only 6 trades with slip<100bps were profitable.",
      "_fix_details": "Disabled entirely. Gap-down momentum shorting not viable. Focus on FHM Long instead.",
      "enabled": false,
      "detect_direction": "short",
      "min_bars_required": 4,
      "require_vwap_hold": false,
      "require_gap_down": false,
      "stop_at_prev_close": true,
      "blocked_cap_segments": {
        "_comment": "SALVAGE FIX: Block small_cap and micro_cap - 0% win rate in backtest analysis",
        "segments": [
          "small_cap",
          "micro_cap"
        ],
        "_rationale": "small_cap: 0% WR, -1,767 Rs | micro_cap: 0% WR, -2,608 Rs | mid_cap: 45% WR, +958 Rs (ONLY profitable)"
      },
      "regime_filter": {
        "_comment": "DATA-DRIVEN: chop = +121 Rs/trade, trend_down = +52, squeeze = +25. Chop only!",
        "short_allowed_regimes": [
          "chop"
        ]
      },
      "time_window": {
        "start": "09:20",
        "end": "10:30",
        "_comment": "First hour momentum window - full window, filtered by multi-bar confirmation"
      },
      "triggers": {
        "min_rvol": 2.0,
        "min_price_move_pct": 1.5,
        "min_volume": 50000,
        "_rvol_comment": "PRO STANDARD: RVOL>=2.0x is DEFAULT - cap-specific thresholds below override",
        "_price_comment": "ISSUE 5 FIX: Relaxed from 3.0% to 1.5% for shorts",
        "_volume_note": "DATA-DRIVEN: Volume filter HURTS shorts! vol>=100k drops avg from +121 to +68. Keep low.",
        "_adx_note": "ADX filter handled by breakout_pipeline gates.adx.fhm_short_min_adx=30"
      },
      "cap_rvol_thresholds": {
        "_comment": "RESEARCH-BASED: Cap-specific RVOL thresholds from FHM research PDF",
        "micro_cap": 3.5,
        "small_cap": 3.0,
        "mid_cap": 2.0,
        "large_cap": 1.5,
        "_rationale": "Small/micro caps need higher RVOL (3.0-3.5x) to filter noise; large caps reliable at 1.5x"
      },
      "multi_bar_confirmation": {
        "enabled": true,
        "min_bearish_bars": 2,
        "lookback_bars": 3,
        "_comment": "RESEARCH: '2 of 3 consecutive 5-min bars bearish' to avoid false spikes"
      },
      "volume_continuation": {
        "enabled": true,
        "min_rvol_continuation": 1.2,
        "lookback_bars": 2,
        "_comment": "RESEARCH: RVOL remain >1.2x in subsequent bars to confirm follow-through"
      },
      "vwap_position": {
        "long_requires_above_vwap": false,
        "short_requires_below_vwap": true,
        "_comment": "Shorts require below VWAP - using multi-bar and volume continuation for quality"
      },
      "entry": {
        "_comment": "Wait for pullback to VWAP AND hold for 1 candle",
        "mode": "pullback",
        "reference": "vwap",
        "zone_atr_mult": 0.1,
        "_zone_comment": "TIGHTENED: 0.15\u21920.10 ATR - Backtest showed winners have lower slippage (146 vs 204 bps)"
      },
      "stop_loss": {
        "_comment": "PRO TRADER: Stop at previous day close (natural resistance for gap down)",
        "reference": "prev_close",
        "pct_of_price": 0.008,
        "buffer_atr_mult": 0.2,
        "_prev_close_comment": "Prev close = natural resistance for gap down shorts"
      },
      "targets": {
        "_comment": "R:R based targets",
        "t1_rr": 1.0,
        "t2_rr": 2.0,
        "t3_rr": 3.0,
        "qty_split": [
          70,
          30,
          0
        ]
      },
      "confidence_high_rvol": 2.0,
      "confidence_base": 1.5,
      "high_rvol_threshold": 3.0
    },
    "vwap_mean_reversion_long": {
      "enabled": true,
      "min_distance_bps": 50,
      "max_distance_bps": 150,
      "_comment_max": "VWAP OPTIMIZATION: 250 \u2192 150 bps (1.50%) - Beyond 1.5% = reversal risk, not mean reversion to VWAP",
      "require_oversold_rsi": false,
      "_comment_rsi": "VWAP OPTIMIZATION: true \u2192 false - CRITICAL FIX - RSI blocking 100% of trades. VWAP edge independent of RSI (Tier 3 optional, not Tier 1 must-have)",
      "oversold_rsi_threshold": 30,
      "overbought_rsi_threshold": 70,
      "min_bars_above_vwap": 2,
      "reclaim_volume_confirmation": true,
      "min_volume_mult": 1.5,
      "_comment_volume": "VWAP OPTIMIZATION: 1.2 \u2192 1.5x - Professional institutional volume confirmation threshold (Tier 1 filter priority)",
      "min_stop_distance_pct": 0.5,
      "stop_distance_mult": 0.75,
      "vwap_buffer_mult": 0.2,
      "target_mult_t1": 1.0,
      "target_mult_t2": 1.5,
      "confidence_strong_signal": 0.8,
      "confidence_weak_signal": 0.6
    },
    "vwap_mean_reversion_short": {
      "enabled": true,
      "min_distance_bps": 50,
      "max_distance_bps": 150,
      "_comment_max": "VWAP OPTIMIZATION: 250 \u2192 150 bps (1.50%) - Beyond 1.5% distance = reversal risk, not mean reversion to VWAP. Same threshold as long side.",
      "require_oversold_rsi": false,
      "_comment_rsi": "VWAP OPTIMIZATION: true \u2192 false - CRITICAL FIX - RSI requirement blocking 100% of mean reversion trades. VWAP edge independent of RSI (Tier 3 optional, not Tier 1 must-have).",
      "overbought_rsi_threshold": 70,
      "oversold_rsi_threshold": 30,
      "min_bars_above_vwap": 2,
      "reclaim_volume_confirmation": true,
      "min_volume_mult": 1.5,
      "_comment_volume": "VWAP OPTIMIZATION: 1.2 \u2192 1.5x - Professional institutional volume confirmation threshold (Tier 1 filter priority). Matches industry standard for conviction signals.",
      "min_stop_distance_pct": 0.5,
      "stop_distance_mult": 0.75,
      "vwap_buffer_mult": 0.2,
      "target_mult_t1": 1.0,
      "target_mult_t2": 1.5,
      "confidence_strong_signal": 0.8,
      "confidence_weak_signal": 0.6
    },
    "range_rejection_long": {
      "enabled": true,
      "min_range_duration": 6,
      "max_range_height_pct": 3.0,
      "min_range_height_pct": 0.5,
      "bounce_tolerance_pct": 0.2,
      "breakout_confirmation_pct": 0.3,
      "require_volume_confirmation": false,
      "min_volume_mult": 1.5,
      "target_mult_t1": 1.0,
      "target_mult_t2": 2.0,
      "confidence_level": 0.7,
      "bounce_sl_buffer_atr": 0.3,
      "_comment_bounce_sl": "ATR buffer beyond range support for rejection SL",
      "breakout_sl_buffer_atr": 0.5,
      "_comment_breakout_sl": "ATR buffer inside range for breakout SL",
      "min_stop_distance_pct": 0.3,
      "_comment_min_stop": "Minimum stop loss distance as percentage of price"
    },
    "range_rejection_short": {
      "enabled": true,
      "min_range_duration": 6,
      "max_range_height_pct": 3.0,
      "min_range_height_pct": 0.5,
      "bounce_tolerance_pct": 0.2,
      "breakout_confirmation_pct": 0.3,
      "require_volume_confirmation": false,
      "min_volume_mult": 1.5,
      "target_mult_t1": 1.0,
      "target_mult_t2": 2.0,
      "confidence_level": 0.7,
      "bounce_sl_buffer_atr": 0.3,
      "_comment_bounce_sl": "ATR buffer beyond range resistance for rejection SL",
      "breakout_sl_buffer_atr": 0.5,
      "_comment_breakout_sl": "ATR buffer inside range for breakout SL",
      "min_stop_distance_pct": 0.3,
      "_comment_min_stop": "Minimum stop loss distance as percentage of price"
    },
    "ict_comprehensive": {
      "enabled": true,
      "order_block_min_move_pct": 0.5,
      "order_block_min_volume_surge": 1.5,
      "order_block_lookback": 20,
      "order_block_test_tolerance_pct": 0.15,
      "fvg_min_gap_pct": 0.1,
      "fvg_max_gap_pct": 1.5,
      "fvg_require_volume_spike": true,
      "fvg_min_volume_mult": 1.5,
      "fvg_fill_tolerance_pct": 0.05,
      "sweep_min_distance_pct": 0.05,
      "sweep_max_distance_pct": 0.3,
      "sweep_min_volume_surge": 2.0,
      "sweep_min_wick_ratio": 0.4,
      "sweep_reversal_bars": 3,
      "premium_threshold_pct": 70.0,
      "discount_threshold_pct": 30.0,
      "range_lookback_bars": 50,
      "bos_min_structure_bars": 10,
      "bos_min_break_pct": 0.2,
      "bos_volume_confirmation": true,
      "choch_momentum_periods": [
        3,
        5,
        8
      ],
      "choch_min_momentum_change_pct": 1.0,
      "choch_volume_threshold": 1.8,
      "risk_pct": 1.0,
      "reward_risk_ratio": 2.0,
      "max_bars_hold": 12,
      "sl_buffer_atr": 0.3,
      "_comment_sl_buffer": "ATR buffer beyond structure level for stop loss placement",
      "min_stop_distance_pct": 0.3,
      "_comment_min_stop": "Minimum stop loss distance as percentage of price",
      "ict_quality_filters": {
        "_comment": "ICT Pattern Quality Filters - Balance between noise filtering and opportunity capture",
        "order_block": {
          "min_block_size_pct": 0.001,
          "min_volume_ratio": 1.1,
          "swing_tolerance_pct": 0.1,
          "min_rejection_wick_pct": 0.15
        },
        "fair_value_gap": {
          "min_gap_size_pct": 0.0005,
          "min_volume_ratio": 1.2,
          "max_wick_penetration_pct": 0.3,
          "vwap_distance_tolerance_pct": 0.25,
          "swing_tolerance_pct": 0.25,
          "_comment": "RELAXED (Dec 2024): Aligned with ict_quality_filters values"
        }
      }
    },
    "order_block_long": {
      "enabled": true,
      "_comment": "ADDED: ICT Order Block long pattern - inherits ict_comprehensive params"
    },
    "order_block_short": {
      "enabled": true,
      "_comment": "ADDED: ICT Order Block short pattern - inherits ict_comprehensive params"
    },
    "fair_value_gap_long": {
      "enabled": true,
      "_comment": "ADDED: ICT Fair Value Gap long pattern - inherits ict_comprehensive params"
    },
    "fair_value_gap_short": {
      "enabled": true,
      "_comment": "ADDED: ICT Fair Value Gap short pattern - inherits ict_comprehensive params"
    },
    "liquidity_sweep_long": {
      "enabled": true,
      "_comment": "ADDED: ICT Liquidity Sweep long pattern - inherits ict_comprehensive params"
    },
    "liquidity_sweep_short": {
      "enabled": true,
      "_comment": "ADDED: ICT Liquidity Sweep short pattern - inherits ict_comprehensive params"
    },
    "premium_zone_short": {
      "enabled": true,
      "_comment": "ADDED: ICT Premium Zone short pattern - inherits ict_comprehensive params"
    },
    "discount_zone_long": {
      "enabled": true,
      "_comment": "ADDED: ICT Discount Zone long pattern - inherits ict_comprehensive params"
    },
    "break_of_structure_long": {
      "enabled": true,
      "_comment": "ADDED: ICT Break of Structure long pattern - inherits ict_comprehensive params"
    },
    "break_of_structure_short": {
      "enabled": true,
      "_comment": "ADDED: ICT Break of Structure short pattern - inherits ict_comprehensive params"
    },
    "change_of_character_long": {
      "enabled": true,
      "_comment": "ADDED: ICT Change of Character long pattern - inherits ict_comprehensive params"
    },
    "change_of_character_short": {
      "enabled": true,
      "_comment": "ADDED: ICT Change of Character short pattern - inherits ict_comprehensive params"
    },
    "trend_reversal_long": {
      "enabled": true,
      "_comment": "Trend reversal long - exhaustion in downtrend leading to reversal. Uses TrendStructure params.",
      "min_pullback_pct": 0.5,
      "max_pullback_pct": 10.0,
      "trend_confirmation_bars": 10,
      "min_trend_bars": 10,
      "pullback_depth_pct": 50.0,
      "min_trend_strength": 1.5,
      "min_momentum_score": 0.4,
      "require_volume_confirmation": false,
      "require_volume_decline": false,
      "max_volume_mult_during_pullback": 0.8,
      "require_rsi_oversold": true,
      "rsi_oversold_threshold": 35,
      "require_rsi_overbought": false,
      "rsi_overbought_threshold": 65,
      "min_volume_mult": 1.3,
      "min_stop_distance_pct": 0.5,
      "stop_distance_mult": 0.75,
      "target_mult_t1": 1.5,
      "target_mult_t2": 2.5,
      "confidence_strong_trend": 0.8,
      "confidence_weak_trend": 0.65,
      "swing_sl_buffer_atr": 0.3,
      "swing_lookback_bars": 10
    },
    "trend_reversal_short": {
      "enabled": true,
      "_comment": "Trend reversal short - exhaustion in uptrend leading to reversal. Uses TrendStructure params.",
      "min_pullback_pct": 0.5,
      "max_pullback_pct": 10.0,
      "trend_confirmation_bars": 10,
      "min_trend_bars": 10,
      "pullback_depth_pct": 50.0,
      "min_trend_strength": 1.5,
      "min_momentum_score": 0.4,
      "require_volume_confirmation": false,
      "require_volume_decline": false,
      "max_volume_mult_during_pullback": 0.8,
      "require_rsi_oversold": false,
      "rsi_oversold_threshold": 35,
      "require_rsi_overbought": true,
      "rsi_overbought_threshold": 65,
      "min_volume_mult": 1.3,
      "min_stop_distance_pct": 0.5,
      "stop_distance_mult": 0.75,
      "target_mult_t1": 1.5,
      "target_mult_t2": 2.5,
      "confidence_strong_trend": 0.8,
      "confidence_weak_trend": 0.65,
      "swing_sl_buffer_atr": 0.3,
      "swing_lookback_bars": 10
    },
    "main_detector": {
      "enabled": true,
      "max_detections_per_symbol": 5,
      "conflict_resolution_enabled": true,
      "priority_weights": {
        "ict": 1.0,
        "level_breakout_long": 0.9,
        "level_breakout_short": 0.9,
        "failure_fade_long": 0.8,
        "failure_fade_short": 0.8,
        "squeeze_release_long": 0.7,
        "squeeze_release_short": 0.7,
        "flag_continuation_long": 0.6,
        "flag_continuation_short": 0.6,
        "momentum_breakout_long": 0.5,
        "momentum_breakout_short": 0.5
      }
    }
  },
  "filters": {
    "adx": {
      "lookback": 14,
      "min": 30.0,
      "max": 45.0
    },
    "rsi14": {
      "min": 35.0,
      "max": 65.0,
      "short_min": 35.0,
      "short_max": 70.0
    },
    "regime": {
      "allow": [
        "trend_up",
        "trend_down",
        "chop"
      ],
      "disallow": [
        "squeeze"
      ]
    },
    "market_sentiment_filters": {
      "bullish_market_long_bias": 1.3,
      "bearish_market_short_bias": 1.3,
      "fear_mean_reversion_bias": 1.4,
      "greed_momentum_bias": 1.2,
      "sector_strength_bonus": 0.15,
      "sector_weakness_penalty": -0.1
    }
  },
  "time_policy": {
    "start_trade": "09:15",
    "_comment_start_trade": "OPENING BELL FIX: Changed from 10:15 to 09:15 - allow entries from market open (premium_zone T1 hits at 09:15-09:30)",
    "lunch_block_start": "12:00",
    "lunch_block_end": "13:00",
    "last_entry_cutoff": "14:45"
  },
  "structure": {
    "max_structural_risk_pct_of_price": 0.003,
    "prefer_levels": [
      "ORL",
      "PDL"
    ],
    "weaken_levels": [
      "VWAP",
      "ORH"
    ]
  },
  "ranking": {
    "min_rank": 0.62,
    "boosts": {
      "trend_aligned": 0.08,
      "level_strength": 0.06,
      "rvwap_confluence": 0.04
    },
    "penalties": {
      "midday": -0.05,
      "high_adx_exhaustion": -0.04,
      "rsi_edge": -0.06
    }
  },
  "news_gate": {
    "window_bars": 30,
    "vol_z_thresh": 5.0,
    "ret_z_thresh": 2.5,
    "body_atr_ratio_thresh": 2.0,
    "require_retest_bars": 2,
    "reduce_size_mult": 0.5
  },
  "t1_rr": 1.5,
  "t2_rr": 3.0,
  "sl_atr_mult": 1.6,
  "_comment_sl_atr_mult": "REVERTED from 2.0 to 1.6 - wider stops were causing 800+ Rs losses instead of 600-700 Rs max",
  "sl_below_swing_ticks": 0.0,
  "_comment_time_based_sl": "=== TIME-BASED SL WIDENING (Pro Trader Standard) ===",
  "_comment_time_sl_rationale": "Research: Morning volatility (10-11 AM) causes 35% hard_sl rate. Pro traders widen stops after time-in-trade to avoid whipsaw. Based on LuxAlgo/TrendSpider ATR strategies.",
  "sl_time_widening_enabled": true,
  "sl_time_widening_after_minutes": 30,
  "_comment_sl_time_minutes": "Minutes after entry before SL widening kicks in (professional standard: 30-60 min)",
  "sl_time_widening_atr_add": 0.3,
  "_comment_sl_atr_add": "Additional ATR to add to SL after time threshold (0.3 ATR = ~15% wider stop)",
  "sl_time_widening_max_r_from_entry": 0.5,
  "_comment_sl_max_r": "Only widen if trade is within this R from entry (prevents widening on clear losers)",
  "sl_time_widening_second_after_minutes": 60,
  "_comment_sl_second_minutes": "Second widening threshold for longer trades",
  "sl_time_widening_second_atr_add": 0.2,
  "_comment_sl_second_atr": "Additional ATR to add at second threshold (cumulative: 0.3 + 0.2 = 0.5 ATR total)",
  "trail_to": "atr",
  "_comment_trail": "REVERT: Trail disabled (T3=0) - trail was losing money in exit-opt-003. Full exit at T2.",
  "exit_t1_book_pct": 60.0,
  "_comment_t1": "FALLBACK ONLY - Pipeline configs should override via trade plan. OLD config was 60-40.",
  "exit_t2_book_pct": 40.0,
  "_comment_t2": "FALLBACK ONLY - Pipeline configs should override via trade plan. OLD config was 60-40.",
  "exit_t1_move_sl_to_be": true,
  "exit_be_buffer_pct": 0.1,
  "_comment_be_buffer": "Buffer above/below breakeven for SL after T1 (0.1% = 10 bps)",
  "exit_trail_atr_mult": 2.0,
  "_comment_trail_mult": "PHASE 2: Trail at 2.0\u00c3\u2014 ATR distance",
  "exit_trail_time_tighten": "14:30",
  "_comment_trail_time": "PHASE 3: Tighten trail after 2:30 PM when NSE liquidity drops",
  "exit_trail_atr_mult_late": 1.5,
  "_comment_trail_late": "PHASE 3: Tighter 1.5\u00c3\u2014 ATR trail after 14:30",
  "exit_time_stop_min": 30.0,
  "exit_time_stop_req_rr": 0.4,
  "exit_score_drop_enabled": true,
  "exit_score_drop_bpct": 30.0,
  "breakout_short_risk_control": true,
  "eod_scale_out": true,
  "entry_cutoff_hhmm": "14:45",
  "eod_squareoff_hhmm": "15:15",
  "_comment_eod": "PHASE 3: Extended from 15:12 to 15:15 to capture 3 extra minutes (safe before 15:20 circuit breaker)",
  "screener_store_5m_max": 120,
  "max_per_cycle": 100,
  "producer_min_interval_sec": 5,
  "rank_exec_threshold": 1.0,
  "rank_pctl_min": 0.6,
  "max_concurrent_positions": 999,
  "_comment_max_positions": "DIAGNOSTIC: Disabled limit (999) to see true setup performance without portfolio competition",
  "time_restricted_trading": true,
  "_comment_execution": "=== EXECUTION SETTINGS ===",
  "exec_order_mode": "MARKET",
  "exec_product": "MIS",
  "exec_variety": "regular",
  "_comment_metrics": "=== METRICS & BAR PROCESSING ===",
  "metrics_min_bars_5m": 20,
  "metrics_rsi_len": 14,
  "metrics_adx_len": 14,
  "metrics_slope_window": 3,
  "metrics_drop_last_forming": true,
  "metrics_enable_vwap": false,
  "_comment_energy_scanner": "=== ENERGY SCANNER (STAGE-0) ===",
  "energy_scanner": {
    "top_k_long": 200,
    "top_k_short": 200,
    "top_k_mr": 20
  },
  "_comment_scanner_filters": "=== SCANNER FILTERS ===",
  "scanner_min_bar5_volume": 1000,
  "scanner_vwap_bps_caps": {
    "early": 120,
    "mid": 140,
    "late": 200
  },
  "scanner_ret1_max": 0.035,
  "scanner_vol_persist_bars": 2,
  "scanner_vol_ratio_min": 1.0,
  "_comment_dedupe": "=== DE-DUPLICATION ===",
  "dedupe_cooloff_bars": 3,
  "dedupe_require_setup_change": true,
  "_comment_websocket": "=== WEBSOCKET SETTINGS ===",
  "ws_batch_size": 100,
  "ws_flush_enabled": true,
  "_comment_ranker": "=== RANKER CONFIGURATION ===",
  "rank_vol_ratio_divisor": 2.0,
  "rank_vol_cap": 3.0,
  "rank_rsi_mid": 50.0,
  "rank_rsi_divisor": 30.0,
  "rank_rsi_floor": -0.5,
  "rank_rsi_slope_cap": 0.3,
  "rank_adx_mid": 25.0,
  "rank_adx_divisor": 20.0,
  "rank_adx_floor": -0.3,
  "rank_adx_slope_cap": 0.2,
  "rank_vwap_bonus": 0.3,
  "rank_vwap_penalty": -0.2,
  "rank_dist_near_bpct": 0.5,
  "rank_dist_ok_bpct": 1.5,
  "rank_dist_near_score": 0.4,
  "rank_dist_ok_score": 0.2,
  "rank_dist_far_score": -0.1,
  "rank_sq_score_le_50": 0.3,
  "rank_sq_score_le_70": 0.2,
  "rank_sq_score_ge_90": -0.2,
  "rank_acceptance_bonus": 0.5,
  "rank_weight_daily": 0.3,
  "rank_weight_intraday": 0.7,
  "rank_top_n": 50,
  "quality_filters": {
    "enabled": true,
    "min_structural_rr": 1.2,
    "_comment_momentum_quality": "INSTITUTIONAL FIX (exit-opt-004-phase2c): Momentum-based quality metric for breakouts. Replaces distance-based structural R:R with volume*breakout_strength/risk. Root cause analysis revealed distance-based R:R is inversely correlated with breakout quality - strong breakouts enter above ORH and had LOW structural R:R. Momentum quality measures what actually matters: volume confirmation + breakout strength + risk efficiency.",
    "strategy_structural_rr_overrides": {
      "breakout_long": 0.3,
      "breakout_short": 0.3,
      "orb_breakout_long": 0.25,
      "orb_breakout_short": 0.25,
      "orb_breakdown_short": 0.25,
      "orb_breakdown_long": 0.25,
      "orb_pullback_long": 0.25,
      "orb_pullback_short": 0.25,
      "flag_continuation_long": 0.4,
      "flag_continuation_short": 0.4
    },
    "min_t1_rr": 1.2,
    "breakout_min_adx": 20.0,
    "min_t2_rr": 1.5,
    "time_windows": {
      "morning_start": "09:15",
      "_comment_morning_start": "OPENING BELL FIX: Changed from 09:25 to 09:15 - allow entries from market open to catch fresh moves (premium_zone T1 hits at 09:15-09:30)",
      "morning_end": "12:40",
      "afternoon_start": "13:20",
      "afternoon_end": "14:45"
    },
    "opening_bell_override": {
      "_comment": "OPENING BELL DETECTION - Professional NSE Strategy (Fix for premium_zone_short late entries)",
      "_rationale": "Evidence: 82% of premium_zone_short trades had T1 hit at 09:15-09:30, but entries at 11:00-14:00 (2-3 hrs late). Scanner now runs early (09:20-09:30) ONLY for ICT setups to catch first 2 candles. Other setups still wait until 09:30+ (normal 3-bar requirement).",
      "enabled": true,
      "start_time": "09:20",
      "end_time": "09:30",
      "_window_comment": "10-minute opening window (09:20-09:30) for ICT setups ONLY - scanner runs with 1 bar minimum to catch first candle (09:15-09:20) like pro traders. Bypasses momentum/range filters, requires 2.0x volume. Other setups blocked until 09:30.",
      "bypass_time_window_filter": true,
      "bypass_momentum_consolidation": true,
      "_momentum_bypass_rationale": "Opening session has high momentum (gap moves) - this is DESIRED, not noise. Momentum filter blocks best entries.",
      "bypass_range_compression": true,
      "_range_compression_bypass_rationale": "Opening session has high ATR (expansion from gap) - this is NORMAL. Range compression filter blocks opening moves.",
      "require_volume_confirmation": true,
      "min_volume_ratio": 2.0,
      "_volume_comment": "2.0x volume = institutional participation (same as ICT standard). Ensures quality opening moves, not retail noise.",
      "allowed_setups": [
        "premium_zone_short",
        "discount_zone_long",
        "order_block_long",
        "order_block_short",
        "orb_breakout_long",
        "orb_breakout_short"
      ],
      "_allowed_setups_comment": "ICT setups + ORB work best at market open (designed for extremes/fresh moves). Other setups still require consolidation."
    },
    "pattern_filters_enabled": true,
    "momentum_consolidation_enabled": true,
    "momentum_consolidation_threshold": 1.0,
    "momentum_consolidation_thresholds": {
      "breakout": 6.0,
      "pullback": 2.5,
      "vwap": 2.0,
      "fade": 1.8,
      "default": 1.0
    },
    "momentum_vwap_deviation_threshold": 0.015,
    "_comment_vwap_threshold": "TIGHTENED: 1.5% from VWAP (was 2.0%) - only early-stage moves, not chasing tops",
    "momentum_volume_ratio_threshold": 2.0,
    "_comment_volume_threshold": "TIGHTENED: 2.0x volume (was 1.5x) - require stronger institutional participation",
    "max_structural_rr": 4.0,
    "high_rr_penalty": -0.3,
    "chop_throttle": {
      "enabled": true,
      "allowed_setups": [
        "orb_pullback_long",
        "failure_fade_long",
        "range_break_retest_short",
        "vwap_reclaim_long",
        "gap_fill_short"
      ]
    },
    "outcome_aware_ranking": {
      "enabled": true,
      "blacklist_penalty": -999.0,
      "unrealistic_rr_penalty": -0.3
    },
    "strategy_momentum_filters": {
      "mean_reversion": {
        "strategies": [
          "failure_fade_long",
          "failure_fade_short",
          "vwap_mean_reversion_long",
          "vwap_mean_reversion_short",
          "volume_spike_reversal_long",
          "volume_spike_reversal_short"
        ],
        "momentum_consolidation_threshold": 0.7
      },
      "range_level_trades": {
        "strategies": [
          "support_bounce_long",
          "resistance_bounce_short",
          "vwap_reclaim_long",
          "vwap_lose_short",
          "range_rejection_long",
          "range_rejection_short"
        ],
        "momentum_consolidation_threshold": 2.5
      },
      "gap_trades": {
        "strategies": [
          "gap_fill_long",
          "gap_fill_short"
        ],
        "momentum_consolidation_threshold": 3.0
      }
    },
    "range_compression_enabled": true,
    "range_compression_threshold": 0.8
  },
  "logging": {
    "enable_enhanced_logging": true,
    "enable_performance_tracking": true,
    "enable_analytics_stream": true,
    "enable_trade_lifecycle": true,
    "performance_update_frequency": "realtime"
  },
  "trigger_system": {
    "enabled": true,
    "expiry_minutes": 45,
    "cancel_existing_pending": true,
    "staleness_seconds": 1800,
    "max_pending_per_symbol": 2,
    "validation_frequency_seconds": 5
  },
  "trigger_conditions": {
    "volume_ratio_min": 1.2,
    "volume_persistence_bars": 2,
    "rsi_range_min": 35,
    "rsi_range_max": 65,
    "adx_min_strength": 15,
    "adx_min_trend": 20
  },
  "trigger_levels": {
    "tolerance_pct_default": 0.1,
    "vwap_minor_dip_pct": 0.05,
    "break_tolerance_pct": 0.05,
    "retest_tolerance_pct": 0.15,
    "pullback_tolerance_pct": 0.15
  },
  "trigger_patterns": {
    "consecutive_requirement_default": 2,
    "pullback_min_bars": 2,
    "break_hold_bars": 2,
    "vwap_reclaim_bars": 3,
    "rejection_confirmation_bars": 1
  },
  "trigger_monitoring": {
    "log_status_interval_seconds": 30,
    "detailed_logging": true,
    "performance_tracking": true
  },
  "_enhanced_strategy_mappings": {
    "_comment": "These map your planner strategies to trigger types",
    "orb_pullback_long": {
      "trigger_type": "pullback_to_level",
      "primary_level": "ORH",
      "confirmation_required": [
        "vwap_above",
        "volume_confirmation"
      ],
      "hold_bars": 2
    },
    "pdh_break_hold_long": {
      "trigger_type": "break_and_hold",
      "primary_level": "PDH",
      "break_confirmation": true,
      "allow_retest": true,
      "hold_bars": 2
    },
    "pdl_break_hold_short": {
      "trigger_type": "break_and_hold",
      "primary_level": "PDL",
      "direction": "short",
      "rejection_retest": true,
      "hold_bars": 2
    },
    "range_break_retest_short": {
      "trigger_type": "break_retest_fail",
      "primary_level": "ORL",
      "pattern": "failed_retest",
      "volume_decline_on_retest": true
    }
  },
  "_logging_enhancements": {
    "_comment": "Enhanced logging for trigger system",
    "trigger_events": {
      "log_pending_added": true,
      "log_condition_checks": false,
      "log_trigger_fired": true,
      "log_execution": true,
      "log_expiry": true
    }
  },
  "market_sentiment": {
    "enabled": true,
    "nifty_momentum": {
      "bullish_threshold": 0.3,
      "bearish_threshold": -0.3,
      "lookback_bars": 10,
      "weight_factor": 1.5
    },
    "banknifty_momentum": {
      "bullish_threshold": 0.4,
      "bearish_threshold": -0.4,
      "lookback_bars": 10,
      "weight_factor": 1.3
    },
    "breadth_indicators": {
      "advance_decline_ratio_bullish": 1.2,
      "advance_decline_ratio_bearish": 0.8,
      "new_highs_lows_ratio_bullish": 1.5,
      "new_highs_lows_ratio_bearish": 0.7
    },
    "vix_sentiment": {
      "fear_threshold": 20.0,
      "greed_threshold": 12.0,
      "extreme_fear_threshold": 30.0,
      "extreme_greed_threshold": 10.0
    },
    "sector_strength": {
      "enabled": true,
      "min_relative_strength": 1.05,
      "top_sectors_count": 5,
      "lookback_days": 5
    },
    "sentiment_bias": {
      "bullish_bias_multiplier": 1.2,
      "bearish_bias_multiplier": 1.2,
      "neutral_multiplier": 1.0,
      "contrarian_mode_enabled": true,
      "extreme_sentiment_fade": true
    }
  },
  "use_enhanced_triggers": true,
  "trigger_expiry_minutes": 15,
  "cancel_existing_pending": true,
  "validation_cache_max_symbols": 100,
  "validation_cache_max_bars_per_symbol": 50,
  "validation_max_time_ms": 50,
  "trigger_default_consecutive_bars": 1,
  "trigger_vwap_tolerance_pct": 0.02,
  "trigger_level_tolerance_pct": 0.1,
  "trigger_volume_min_ratio": 1.2,
  "trigger_rsi_period": 14,
  "trigger_adx_period": 14,
  "trigger_ema_period": 9,
  "orb_pullback_tolerance_pct": 0.15,
  "orb_pullback_hold_bars": 2,
  "orb_pullback_max_minutes": 90,
  "orb_require_index_alignment": true,
  "vwap_reclaim_min_consecutive": 3,
  "vwap_reclaim_volume_confirmation": true,
  "vwap_volume_persistence_bars": 3,
  "vwap_min_resistance_distance_atr": 0.2,
  "require_higher_timeframe_alignment": true,
  "daily_trend_ema_period": 20,
  "pdh_break_tolerance_pct": 0.05,
  "pdh_hold_bars": 2,
  "pdl_break_tolerance_pct": 0.05,
  "range_break_retest_max_pct": 0.15,
  "momentum_min_ema_slope": 0.001,
  "rsi_bullish_min": 40,
  "rsi_bullish_max": 70,
  "rsi_bearish_min": 30,
  "rsi_bearish_max": 55,
  "adx_strength_min": 15,
  "adx_trend_min": 20,
  "volume_persistence_min_ratio": 1.3,
  "volume_persistence_bars": 2,
  "breakout_volume_min_ratio": 1.4,
  "require_breakout_bar_volume_surge": true,
  "rejection_min_body_pct": 0.6,
  "condition_state_cleanup_hours": 24,
  "cache_cleanup_interval_minutes": 60,
  "order_idle_ms": 250,
  "order_rate_limit": 1,
  "order_retry_max": 3,
  "acceptance": {
    "bars": 3,
    "retest_bpct": 2.5,
    "need_vwap_hold": false
  },
  "strategy_ranking_profiles": {
    "mean_reversion": {
      "strategies": [
        "failure_fade_long",
        "failure_fade_short",
        "vwap_mean_reversion_long",
        "vwap_mean_reversion_short",
        "volume_spike_reversal_long",
        "volume_spike_reversal_short"
      ],
      "rank_vol_ratio_divisor": 4.0,
      "rank_vol_cap": 2.0,
      "rank_adx_mid": 35.0,
      "rank_adx_divisor": 25.0,
      "rank_vwap_bonus": 0.2,
      "rank_vwap_penalty": -0.1,
      "rank_dist_near_score": 0.2,
      "rank_acceptance_bonus": 0.5,
      "base_threshold": 0.5
    },
    "orb_early_session": {
      "strategies": [
        "orb_breakout_long",
        "orb_breakout_short",
        "orb_breakdown_short",
        "orb_breakdown_long",
        "orb_breakout",
        "orb_breakdown",
        "orb_pullback_long",
        "orb_pullback_short"
      ],
      "rank_vol_ratio_divisor": 1.5,
      "rank_vol_cap": 4.0,
      "rank_adx_mid": 20.0,
      "rank_adx_divisor": 15.0,
      "rank_vwap_bonus": 0.4,
      "rank_vwap_penalty": -0.3,
      "rank_dist_near_score": 0.6,
      "rank_acceptance_bonus": 0.2,
      "base_threshold": 0.0
    },
    "ict_setups": {
      "strategies": [
        "change_of_character_long",
        "change_of_character_short",
        "premium_zone_short",
        "premium_zone_long",
        "discount_zone_long",
        "fair_value_gap_long",
        "fair_value_gap_short",
        "order_block_long",
        "order_block_short",
        "liquidity_sweep_long",
        "liquidity_sweep_short",
        "equilibrium_breakout_long",
        "equilibrium_breakout_short"
      ],
      "rank_vol_ratio_divisor": 3.0,
      "rank_vol_cap": 2.5,
      "rank_adx_mid": 30.0,
      "rank_adx_divisor": 20.0,
      "rank_vwap_bonus": 0.3,
      "rank_vwap_penalty": -0.2,
      "rank_dist_near_score": 0.3,
      "rank_acceptance_bonus": 0.5,
      "base_threshold": 1.0
    },
    "momentum_breakout": {
      "strategies": [
        "breakout_long",
        "breakout_short",
        "flag_continuation_long",
        "flag_continuation_short",
        "trend_pullback_long",
        "trend_pullback_short"
      ],
      "rank_vol_ratio_divisor": 1.5,
      "rank_vol_cap": 4.0,
      "rank_adx_mid": 20.0,
      "rank_adx_divisor": 15.0,
      "rank_vwap_bonus": 0.4,
      "rank_vwap_penalty": -0.3,
      "rank_dist_near_score": 0.6,
      "rank_acceptance_bonus": 0.2,
      "base_threshold": 1.8
    },
    "range_bound": {
      "strategies": [
        "range_rejection_long",
        "range_rejection_short",
        "support_bounce_long",
        "resistance_bounce_short",
        "vwap_reclaim_long",
        "vwap_lose_short"
      ],
      "rank_vol_ratio_divisor": 3.0,
      "rank_vol_cap": 2.5,
      "rank_adx_mid": 30.0,
      "rank_adx_divisor": 20.0,
      "rank_sq_score_le_50": 0.5,
      "rank_sq_score_le_70": 0.3,
      "rank_acceptance_bonus": 0.4,
      "base_threshold": 1.0
    },
    "gap_fill": {
      "strategies": [
        "gap_fill_long",
        "gap_fill_short"
      ],
      "rank_vol_ratio_divisor": 2.5,
      "rank_vol_cap": 3.0,
      "rank_adx_mid": 25.0,
      "rank_adx_divisor": 20.0,
      "rank_vwap_bonus": 0.3,
      "rank_acceptance_bonus": 0.5,
      "base_threshold": 1.6
    },
    "squeeze_expansion": {
      "strategies": [
        "squeeze_release_long",
        "squeeze_release_short"
      ],
      "rank_vol_ratio_divisor": 1.8,
      "rank_vol_cap": 3.5,
      "rank_adx_mid": 22.0,
      "rank_sq_score_le_50": 0.6,
      "rank_acceptance_bonus": 0.4,
      "base_threshold": 1.7
    }
  },
  "planner_strategy_mapping": {
    "pdl_break_hold_short": "momentum_breakout",
    "generic_long_from_failure_fade_long": "mean_reversion",
    "generic_long_from_range_rejection_long": "range_bound",
    "generic_long_from_support_bounce_long": "range_bound"
  },
  "exits": {
    "score_drop_enabled": true,
    "score_drop_bpct": 30.0,
    "time_stop_min": 45.0,
    "time_stop_req_rr": 0.5,
    "breakout_short_risk_control": true,
    "breakout_short_initial_stop_mult": 0.7,
    "breakout_short_partial_rr": 0.6,
    "breakout_short_partial_pct": 50.0,
    "breakout_short_sl_to_neg": -0.1,
    "breakout_short_time_stop_min": 30.0,
    "breakout_short_time_stop_max": 45.0,
    "breakout_short_time_stop_rr": 0.4,
    "eod_scale_out": true,
    "eod_scale_out_time1": "15:00",
    "eod_scale_out_time2": "15:07",
    "eod_scale_out_rr1": 0.7,
    "eod_scale_out_rr2": 0.4,
    "eod_scale_out_pct1": 50.0
  },
  "structure_manager": {
    "enabled": true,
    "min_structure_score": 25.0,
    "max_structures_per_symbol": 3,
    "structure_priorities": {
      "orb": 10,
      "vwap": 20,
      "support_resistance": 30,
      "trend": 40,
      "volume": 50,
      "gap": 60,
      "range": 70,
      "order_block": 80,
      "liquidity": 90,
      "pattern": 100
    },
    "logging": {
      "log_all_detections": true,
      "log_rejection_reasons": true,
      "log_config_validation": true,
      "performance_tracking": true
    }
  },
  "min_entry_sl_distance_pct": 0.003,
  "min_entry_sl_distance_abs": 0.05,
  "_comment_capital_management": "=== CAPITAL MANAGEMENT & MIS ===",
  "capital_management": {
    "enabled": false,
    "initial_capital": 500000,
    "max_concurrent_positions": 50,
    "risk": {
      "mode": "percentage",
      "fixed_amount": 1000,
      "percentage": 0.01,
      "_comment": "mode=percentage uses capital*percentage, mode=fixed uses fixed_amount in Rs."
    },
    "min_notional_pct": 0.04,
    "capital_utilization": 0.85,
    "max_allocation_per_trade": 0.2,
    "_comment_sizing": "min_notional=4% min position, capital_util=85% safety buffer, max_alloc=20% max per trade",
    "mis_leverage": {
      "enabled": false,
      "_comment": "MIS leverage data is read from nse_all.json (mis_leverage field). This just enables/disables the feature."
    },
    "_modes": {
      "_comment": "Three operational modes",
      "mode_1": "capital_management.enabled=false -> Unlimited capital (for strategy dev)",
      "mode_2": "capital_management.enabled=true + mis_leverage.enabled=false -> 1x leverage (delivery)",
      "mode_3": "capital_management.enabled=true + mis_leverage.enabled=true -> MIS 5-20x leverage (intraday)"
    }
  },
  "planner_precision": {
    "t1_max_mm_frac": 2.0,
    "t2_max_mm_frac": 3.0,
    "t1_max_pct": 100.0,
    "t2_max_pct": 100.0,
    "rr_clip_max": 6.0,
    "t1_min_rr": 1.0,
    "_comment": "Option B: Increase measured move caps to 2x and 3x to allow configured 1.5R and 3.0R targets while maintaining structure-based safety"
  },
  "_comment_market_data_bus": "=== MARKET DATA BUS (Multi-Instance Trading) ===",
  "market_data_bus": {
    "mode": "standalone",
    "_comment_mode": "standalone=local only (default), subscriber=receive from Market Data Service. Use --shared-market-data flag to enable subscriber mode.",
    "redis_url": "redis://localhost:6379/0",
    "publish_1m_bars": false,
    "_comment_1m": "Only used by Market Data Service (python -m market_data.market_data_service --publish-1m)",
    "ltp_mode": "standalone",
    "_comment_ltp_mode": "standalone=local cache, subscriber=read from Redis. Follows 'mode' setting.",
    "_usage": "1) redis-server  2) python -m market_data.market_data_service  3) python main.py --shared-market-data",
    "daily_cache_redis": {
      "enabled": true,
      "_comment": "Share daily OHLCV cache via Redis. MDS pre-warms (rolling cache from yesterday) and stores; subscribers load from Redis (~1-3s vs ~17min API). Set enabled:true when using multi-instance with Redis.",
      "ttl_hours": 24,
      "compression_level": 6,
      "max_size_mb": 200
    }
  },
  "_comment_tick_recording": "=== TICK RECORDING (Market Data Archive) ===",
  "tick_recording": {
    "enabled": true,
    "buffer_size": 50000,
    "_comment": "Records ticks to data/sidecar/ticks/ for backtesting. Can also run standalone: python -m market_data.tick_recorder"
  },
  "_comment_late_start_warmup": "=== LATE START WARMUP (Subscriber Mode) ===",
  "late_start_warmup": {
    "enabled": true,
    "threshold_minutes": 30,
    "_comment": "If starting >30min after 09:15, backfill 5m bar history from Redis to pre-warm indicators"
  }
}